import{M as V}from"./HasModal-fa56130c.js";import{B as T}from"./Button-b3acaac2.js";import{B as M}from"./ButtonIcon-05c24ca4.js";import{B as x}from"./ButtonLink-71ebb617.js";import{B as O}from"./LanguageTab-090d99fd.js";import{B as j}from"./Select-c82d82bb.js";import{B as F}from"./ModalCard-42b1747b.js";import{B as N,a as A}from"./Tabs-f7006a1f.js";import{F as R}from"./FormBuilder-907cd83e.js";import q from"./FormDetail-7f9c2855.js";import E from"./FormSetting-c2ddf47a.js";import{B as v,I as h,l as H,f,i as n,p as s,q as a,s as g,x as W,w as G,u as _,r,o as m,k as c,t as w,F as J,j as K}from"./vue-loading.min-aa20e13d.js";import{i as B,u as y}from"./utils-79a9c8b1.js";import{p as Q}from"./icon-class-4ab3933f.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import"./Icon-150b61ef.js";import"./Link-2bcf0cab.js";import"./Field-fbae01a6.js";import"./Field-c2e062a9.js";import"./InputError-bc1e9f36.js";import"./Select-9fda6861.js";import"./Card-52ddfc57.js";import"./TRBLInput-45f07beb.js";import"./Checkbox-8d9a17c8.js";import"./Input-50a73630.js";import"./Input-2fb71e37.js";import"./NumberAddons-c3a445ee.js";import"./Number-2731510a.js";import"./FieldHorizontal-b8491cae.js";import"./style-options-cda219e9.js";import"./alert-e0e75cb7.js";import"./sweetalert2.all-ebd52f41.js";import"./MediaTextEditor-0dbb0342.js";import"./MediaLibrary-5a0e38b7.js";import"./HasLoader-a564cfe6.js";import"./HasPageErrors-4d447fdf.js";import"./ButtonsDisplayView-1ca29618.js";import"./Dropdown-5425ae3a.js";import"./Search-cafe34ab.js";import"./Image-52e0dacd.js";import"./InputFile-1187b7e3.js";import"./Gallery-48abb118.js";import"./ButtonDownload-ab8e1361.js";import"./Modal-247c5739.js";import"./Table-2efbef14.js";import"./cropper-5d594675.js";import"./Pagination-8d9b0028.js";import"./TableInfo-c372d0e5.js";import"./Form-a078ed17.js";import"./ErrorNotifications-805a6bc2.js";import"./Textarea-18e9b25c.js";import"./Textarea-3c29db5c.js";import"./fontawesome-brand-classes-2990e3e2.js";import"./DropdownSearch-783ef1d1.js";import"./DropdownSearch-bd4068c6.js";import"./vuedraggable.umd-12c8e910.js";import"./ToolbarContent-f242e09a.js";import"./EditorTinymce-70ed286a.js";import"./Slug-b92c239f.js";import"./InputAddons-48095339.js";const Y={name:"PageForm",components:{BizButton:T,BizButtonIcon:M,BizButtonLink:x,BizLanguageTab:O,BizFormSelect:j,BizModalCard:F,BizProvideInjectTab:N,BizProvideInjectTabs:A,FormBuilder:R,FormDetail:q,FormSetting:E},mixins:[V],inject:["can"],provide(){return{dataImages:this.images}},props:{contentConfigId:{type:String,required:!0},emptyPageLocaleOptions:{type:Array,default:()=>[]},errors:{type:Object,default:()=>{}},isDirty:{type:Boolean,default:!1},isNew:{type:Boolean,required:!0},isPageBuilderRendered:{type:Boolean,default:!0},isPageSettingRendered:{type:Boolean,default:!0},localeOptions:{type:Array,default:()=>[]},modelValue:{type:Object,required:!0},pagePreview:{type:Boolean,default:!1},pagePreviewUrl:{type:String,default:null},selectedLocale:{type:String,required:!0},statusOptions:{type:Array,default:()=>[]},tabActive:{type:[Boolean,null,String],default:null}},emits:["on-change-locale","on-delete-translation","on-duplicate-translation","on-submit","update:contentConfigId"],setup(i,{emit:e}){let l=null;!B(i.tabActive)&&i.tabActive==="builder"?l=v(1):l=v(0);const o=h().props.value.images;return{activeTab:l,form:y(i,e),computedContentConfigId:y(i,e,"contentConfigId"),defaultLocale:h().props.value.defaultLanguage,images:B(o)?{}:o,iconPreview:Q}},data(){return{disableInput:!1,formDuplicate:{to:null}}},computed:{canPreview(){return this.can.page.read&&this.form.id&&!this.isDirty},deleteTranslationIsShowed(){var i,e,l;return this.defaultLocale!==this.selectedLocale&&((i=this.form)==null?void 0:i.id)&&((l=(e=this.can)==null?void 0:e.page)==null?void 0:l.delete)},duplicateTranslationIsShowed(){var i;return!!((i=this.form)!=null&&i.id)}},methods:{openShow(i){let e=this.pagePreviewUrl??this.getShowUrl(this.selectedLocale,i);window.open(e,"_blank")},getShowUrl(i,e){let l=null,o=route("frontend.pages.show",{page_translation:e.slug}),d=new URL(o);return i!==this.defaultLocale?l=o.replace(d.pathname,"/"+i+d.pathname):l=o,l},onChangeLocale(i){this.$emit("on-change-locale",i)},onDuplicateTranslation(){this.formDuplicate.to&&(this.images[this.formDuplicate.to]=H.cloneDeep(this.images[this.selectedLocale]),this.$emit("on-duplicate-translation",{locale:this.formDuplicate.to,form:{id:null,title:this.form.title,slug:this.form.slug,excerpt:this.form.excerpt,data:this.form.data,meta_description:this.form.meta_description,meta_title:this.form.meta_title,status:0,settings:this.form.settings}}),this.closeModal(),this.formDuplicate.to=null)},onCloseModal(){this.formDuplicate.to=null}}},Z={key:0,class:"columns"},$={class:"column"},ee={class:"buttons is-right"},te=n("span",null,"Page Preview",-1),oe={class:"columns my-0"},ie={class:"column py-0"},le={class:"mb-5"},ne={class:"columns"},ae={class:"column"},se={class:"buttons"},re={class:"column"},de={class:"buttons is-pulled-right"},me=n("p",{class:"modal-card-title has-text-weight-bold"}," Duplicate Translation ",-1),ue=n("option",{value:null}," - Select Translation - ",-1),ce=["value"],pe={class:"columns mx-0",style:{width:"100%"}},fe={class:"column px-0"},ge={class:"is-pulled-right"};function be(i,e,l,o,d,u){const C=r("biz-button-icon"),k=r("biz-language-tab"),z=r("form-detail"),b=r("biz-provide-inject-tab"),L=r("form-builder"),D=r("form-setting"),P=r("biz-provide-inject-tabs"),p=r("biz-button"),S=r("biz-button-link"),U=r("biz-form-select"),I=r("biz-modal-card");return m(),f("div",null,[l.pagePreview?(m(),f("div",Z,[n("div",$,[n("p",ee,[s(C,{icon:o.iconPreview,disabled:!u.canPreview,onClick:e[0]||(e[0]=t=>u.openShow(l.modelValue))},{default:a(()=>[te]),_:1},8,["icon","disabled"])])])])):g("",!0),n("div",oe,[n("div",ie,[s(k,{class:"is-right","locale-options":l.localeOptions,"selected-locale":l.selectedLocale,onOnChangeLocale:u.onChangeLocale},null,8,["locale-options","selected-locale","onOnChangeLocale"])])]),n("form",{method:"post",onSubmit:e[13]||(e[13]=G(t=>i.$emit("on-submit"),["prevent"]))},[n("div",le,[s(P,{modelValue:o.activeTab,"onUpdate:modelValue":e[10]||(e[10]=t=>o.activeTab=t),class:"is-boxed"},{default:a(()=>[s(b,{title:"Details"},{default:a(()=>[s(z,{title:o.form.title,"onUpdate:title":e[1]||(e[1]=t=>o.form.title=t),slug:o.form.slug,"onUpdate:slug":e[2]||(e[2]=t=>o.form.slug=t),excerpt:o.form.excerpt,"onUpdate:excerpt":e[3]||(e[3]=t=>o.form.excerpt=t),"meta-description":o.form.meta_description,"onUpdate:metaDescription":e[4]||(e[4]=t=>o.form.meta_description=t),"meta-title":o.form.meta_title,"onUpdate:metaTitle":e[5]||(e[5]=t=>o.form.meta_title=t),status:o.form.status,"onUpdate:status":e[6]||(e[6]=t=>o.form.status=t),"disable-input":d.disableInput,errors:l.errors,"selected-locale":l.selectedLocale,"status-options":l.statusOptions},null,8,["title","slug","excerpt","meta-description","meta-title","status","disable-input","errors","selected-locale","status-options"])]),_:1}),s(b,{title:"Builder","is-rendered":l.isPageBuilderRendered},{default:a(()=>[s(L,{id:"page-form-builder",modelValue:o.form.data,"onUpdate:modelValue":e[7]||(e[7]=t=>o.form.data=t),"content-config-id":o.computedContentConfigId,"onUpdate:contentConfigId":e[8]||(e[8]=t=>o.computedContentConfigId=t),"selected-locale":l.selectedLocale},null,8,["modelValue","content-config-id","selected-locale"])]),_:1},8,["is-rendered"]),s(b,{title:"Settings","is-rendered":l.isPageSettingRendered},{default:a(()=>[s(D,{modelValue:o.form.settings,"onUpdate:modelValue":e[9]||(e[9]=t=>o.form.settings=t),errors:l.errors,"selected-locale":l.selectedLocale},null,8,["modelValue","errors","selected-locale"])]),_:1},8,["is-rendered"])]),_:1},8,["modelValue"])]),W(i.$slots,"action",{isNew:l.isNew},()=>[n("div",ne,[n("div",ae,[n("div",se,[u.duplicateTranslationIsShowed?(m(),_(p,{key:0,type:"button",class:"is-link",onClick:e[11]||(e[11]=t=>i.openModal())},{default:a(()=>[c(" Duplicate ")]),_:1})):g("",!0),u.deleteTranslationIsShowed?(m(),_(p,{key:1,type:"button",class:"is-danger",onClick:e[12]||(e[12]=t=>i.$emit("on-delete-translation"))},{default:a(()=>[c(" Remove ")]),_:1})):g("",!0)])]),n("div",re,[n("div",de,[s(S,{class:"is-link is-light",href:i.route("admin.pages.index")},{default:a(()=>[c(" Cancel ")]),_:1},8,["href"]),s(p,{class:"is-link"},{default:a(()=>[c(w(l.isNew?"Create":"Update"),1)]),_:1})])])])])],32),i.isModalOpen?(m(),_(I,{key:1,onClose:e[18]||(e[18]=t=>i.closeModal())},{header:a(()=>[me,n("button",{"aria-label":"close",class:"delete",onClick:e[14]||(e[14]=t=>i.closeModal())})]),footer:a(()=>[n("div",pe,[n("div",fe,[n("div",ge,[s(p,{onClick:e[16]||(e[16]=t=>i.closeModal())},{default:a(()=>[c(" Cancel ")]),_:1}),s(p,{class:"is-link",disabled:!d.formDuplicate.to,onClick:e[17]||(e[17]=t=>u.onDuplicateTranslation())},{default:a(()=>[c(" Duplicate ")]),_:1},8,["disabled"])])])])]),default:a(()=>[s(U,{modelValue:d.formDuplicate.to,"onUpdate:modelValue":e[15]||(e[15]=t=>d.formDuplicate.to=t),label:"To","is-fullwidth":!0},{default:a(()=>[ue,(m(!0),f(J,null,K(l.emptyPageLocaleOptions,t=>(m(),f("option",{key:t.id,value:t.id},w(t.name),9,ce))),128))]),_:1},8,["modelValue"])]),_:1})):g("",!0)])}const Ct=X(Y,[["render",be]]);export{Ct as default};

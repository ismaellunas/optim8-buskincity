import{M as Q}from"./FilterDataHandle-94157290.js";import{M as A}from"./HasModal-fa56130c.js";import{A as F}from"./AppLayout-25ccdbdb.js";import{B as L}from"./Button-b3acaac2.js";import{B as j}from"./ButtonLink-71ebb617.js";import{B as U}from"./Checkbox-8d9a17c8.js";import{B as I,a as T}from"./Dropdown-5425ae3a.js";import{B as H}from"./DropdownSearch-bd4068c6.js";import{B as W}from"./DateRange-7ae8c660.js";import{B as Y}from"./Search-cafe34ab.js";import{B as G}from"./Icon-150b61ef.js";import{B as J}from"./Link-2bcf0cab.js";import{B as K}from"./TableIndex-6b2a4ef8.js";import X from"./ModalCancelEventConfirmation-a890d76d.js";import{i as Z}from"./icon-class-4ab3933f.js";import{c as $,o as O,s as w}from"./alert-e0e75cb7.js";import{B as h,l as k,H as ee,z as te,f as y,i as n,p as i,q as a,u,s as g,r,o as c,t as d,F as C,j as v,k as f,w as ne,n as oe}from"./vue-loading.min-aa20e13d.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasLoader-a564cfe6.js";import"./Breadcrumbs-0b4348b1.js";import"./utils-79a9c8b1.js";import"./NavbarItem-7e983d41.js";import"./Input-2fb71e37.js";import"./Datepicker-847140ac.js";import"./moment-fbc5633a.js";import"./ButtonIcon-05c24ca4.js";import"./Field-c2e062a9.js";import"./Pagination-8d9b0028.js";import"./Table-2efbef14.js";import"./TableInfo-c372d0e5.js";import"./Textarea-18e9b25c.js";import"./Field-fbae01a6.js";import"./InputError-bc1e9f36.js";import"./Textarea-3c29db5c.js";import"./ModalCard-42b1747b.js";import"./booking-icon-853771cf.js";import"./sweetalert2.all-ebd52f41.js";const ae={components:{BizButton:L,BizButtonLink:j,BizCheckbox:U,BizDropdown:I,BizDropdownItem:T,BizDropdownSearch:H,BizFilterDateRange:W,BizFilterSearch:Y,BizIcon:G,BizLink:J,BizTableIndex:K,ModalCancelEventConfirmation:X},mixins:[Q,A],layout:F,props:{baseRouteName:{type:String,required:!0},can:{type:Object,required:!0},pageQueryParams:{type:Object,default:()=>{}},records:{type:Object,required:!0},statusOptions:{type:Object,required:!0},cityOptions:{type:Object,required:!0}},setup(t){var l,s,z,m;const o={message:null};return{queryParams:h({...t.pageQueryParams}),dates:h(k.isArray((l=t.pageQueryParams)==null?void 0:l.dates)?(s=t.pageQueryParams)==null?void 0:s.dates.filter(Boolean):[]),statuses:h(((z=t.pageQueryParams)==null?void 0:z.status)??[]),term:h(((m=t.pageQueryParams)==null?void 0:m.term)??null),form:ee(o),selectedOrder:h(null),icon:Z,filteredCities:h(t.cityOptions.slice(0,10))}},methods:{deleteRecord(t){const o=this;$().then(l=>{l.isConfirmed&&o.$inertia.delete(route(this.baseRouteName+".destroy",t.id),{onStart:o.onStartLoadingOverlay,onFinish:o.onEndLoadingOverlay,onError:()=>{O()},onSuccess:s=>{w(s.props.flash.message)}})})},onStatusChanged(){this.queryParams.status=this.statuses,this.refreshWithQueryParams()},onDateRangeChanged(){this.queryParams.dates=this.dates,this.refreshWithQueryParams()},onCityChange(t=null){this.queryParams.city=t,this.refreshWithQueryParams()},cancel(){const t=this;t.form.post(route(t.baseRouteName+".cancel",t.selectedOrder.id),{onStart:()=>t.onStartLoadingOverlay(),onFinish:()=>t.onEndLoadingOverlay(),onError:o=>{O()},onSuccess:o=>{t.closeModal(),w(o.props.flash.message)}})},openModal(t){this.selectedOrder=t,this.form.reset(),this.isModalOpen=!0,this.onShownModal()},hasMoreAction(t){return t.can.reschedule||t.can.cancel},searchCity:k.debounce(function(t){!k.isEmpty(t)&&t.length>1?this.filteredCities=k.filter(this.cityOptions,function(o){return new RegExp(t,"i").test(o)}).slice(0,10):this.filteredCities=this.cityOptions.slice(0,10)},te)}},ie={class:"box"},le={class:"columns is-multiline"},re={class:"column is-4-desktop"},ce={class:"column is-2-desktop"},de={class:"column is-4 is-3-widescreen"},me={class:"column is-narrow is-3-widescreen"},ue=n("tr",null,[n("th",null,"Status"),n("th",null,"Name"),n("th",null,"City"),n("th",null,"User"),n("th",null,"Date"),n("th",null,"Timezone"),n("th",null,"Time"),n("th",null,"Check-In"),n("th",null,[n("div",{class:"level-right"}," Actions ")])],-1),he={class:"level-right"},fe={class:"buttons"},_e=n("span",null,"Reschedule",-1),pe=n("span",null,"Cancel",-1);function ye(t,o,l,s,z,m){const S=r("biz-filter-search"),_=r("biz-icon"),M=r("biz-checkbox"),b=r("biz-dropdown-item"),B=r("biz-dropdown"),x=r("biz-filter-date-range"),P=r("biz-dropdown-search"),q=r("biz-button-link"),V=r("biz-link"),D=r("biz-table-index"),R=r("biz-button"),E=r("modal-cancel-event-confirmation");return c(),y("div",ie,[n("div",le,[n("div",re,[i(S,{modelValue:s.term,"onUpdate:modelValue":o[0]||(o[0]=e=>s.term=e),onSearch:t.search},null,8,["modelValue","onSearch"])]),n("div",ce,[i(B,{class:"is-fullwidth","close-on-click":!1},{trigger:a(()=>[n("span",null,"Status ("+d(s.statuses.length)+")",1),i(_,{class:"is-small",icon:s.icon.angleDown},null,8,["icon"])]),default:a(()=>[(c(!0),y(C,null,v(l.statusOptions,e=>(c(),u(b,{key:e.id},{default:a(()=>[i(M,{checked:s.statuses,"onUpdate:checked":o[1]||(o[1]=p=>s.statuses=p),value:e.id,onChange:m.onStatusChanged},{default:a(()=>[f("   "+d(e.value),1)]),_:2},1032,["checked","value","onChange"])]),_:2},1024))),128))]),_:1})]),n("div",de,[i(x,{modelValue:s.dates,"onUpdate:modelValue":[o[2]||(o[2]=e=>s.dates=e),m.onDateRangeChanged],"max-range":"31"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",me,[i(P,{class:"is-fullwidth","close-on-click":!0,onSearch:o[4]||(o[4]=e=>m.searchCity(e))},{trigger:a(()=>[n("span",null,d(s.queryParams.city??"Any"),1)]),default:a(()=>[i(b,{onClick:o[3]||(o[3]=e=>m.onCityChange())},{default:a(()=>[f(" Any ")]),_:1}),(c(!0),y(C,null,v(s.filteredCities,(e,p)=>(c(),u(b,{key:p,onClick:N=>m.onCityChange(e)},{default:a(()=>[f(d(e),1)]),_:2},1032,["onClick"]))),128))]),_:1})])]),i(D,{records:l.records,"query-params":s.queryParams},{thead:a(()=>[ue]),default:a(()=>[(c(!0),y(C,null,v(l.records.data,(e,p)=>(c(),y("tr",{key:e.id},[n("td",null,d(e.status),1),n("td",null,d(e.product_name),1),n("td",null,d(e.city),1),n("td",null,d(e.customer_name??"-"),1),n("td",null,d(e.date),1),n("td",null,d(e.timezone),1),n("td",null,d(e.start_end_time),1),n("td",null,d(e.check_in_time),1),n("td",null,[n("div",he,[n("div",fe,[l.can.read?(c(),u(q,{key:0,class:"has-text-black",title:"Detail",href:t.route(l.baseRouteName+".show",e.id)},{default:a(()=>[i(_,{class:"is-small",icon:s.icon.show},null,8,["icon"])]),_:2},1032,["href"])):g("",!0),m.hasMoreAction(e)?(c(),u(B,{key:1,class:oe(["is-right",{"is-up":p>l.records.data.length-3}]),"close-on-click":!1},{trigger:a(()=>[i(_,{class:"is-small",icon:s.icon.ellipsis},null,8,["icon"])]),default:a(()=>[e.can.reschedule?(c(),u(V,{key:0,class:"dropdown-item",href:t.route(l.baseRouteName+".reschedule",e.id)},{default:a(()=>[i(_,{class:"is-small",icon:s.icon.recycle},null,8,["icon"]),f("  "),_e]),_:2},1032,["href"])):g("",!0),e.can.cancel?(c(),u(b,{key:1,tag:"a",onClick:ne(N=>m.openModal(e),["prevent"])},{default:a(()=>[i(_,{class:"is-small",icon:s.icon.remove},null,8,["icon"]),f("  "),pe]),_:2},1032,["onClick"])):g("",!0)]),_:2},1032,["class"])):g("",!0)])])])]))),128))]),_:1},8,["records","query-params"]),t.isModalOpen&&s.selectedOrder?(c(),u(E,{key:0,modelValue:s.form.message,"onUpdate:modelValue":o[6]||(o[6]=e=>s.form.message=e),title:"Cancel Event",event:s.selectedOrder.event,"product-name":s.selectedOrder.product_name,onClose:o[7]||(o[7]=e=>t.closeModal())},{actions:a(()=>[i(R,{class:"is-danger ml-1",type:"button",onClick:o[5]||(o[5]=e=>m.cancel())},{default:a(()=>[f(" Yes for sure ")]),_:1})]),_:1},8,["modelValue","event","product-name"])):g("",!0)])}const tt=se(ae,[["render",ye]]);export{tt as default};

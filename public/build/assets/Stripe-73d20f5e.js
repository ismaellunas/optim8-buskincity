import{A as D}from"./AppLayout-40f8bbe7.js";import{B as T}from"./Button-03e0d3fd.js";import{B as H}from"./Checkbox-8f917da5.js";import{a as K}from"./Dropdown-034da47d.js";import{B as Q}from"./ErrorNotifications-090d6193.js";import{B as R}from"./DropdownSearch-eb09b8b3.js";import{a as I}from"./Field-a8082082.js";import{B as W}from"./Input-137492c5.js";import{B as G}from"./InputAddons-7c9a4924.js";import{B as J}from"./InputColor-f4c2e688.js";import{B as w}from"./InputError-9b7084c8.js";import{M as X}from"./HasModal-fa56130c.js";import{u as Y}from"./utils-caa7a80b.js";import{r as i,o as d,u as h,P as Z,q as m,k as b,t as f,p as a,Q as $,H as ee,l as p,z as oe,f as _,i as e,w as g,s as F,F as z,j as v,n as te,a1 as se}from"./vue-loading.min-a6a947f0.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";import{B as ne}from"./File-58357ba0.js";import{B as re}from"./Image-c2b8efed.js";import{B as le}from"./Select-19a91b6e.js";import{B as ie}from"./Table-6b0ddb68.js";import{M as ae}from"./HasPageErrors-da5616c1.js";import{i as me}from"./icon-class-4ab3933f.js";import{s as de,o as ue}from"./alert-fe3154bb.js";import"./Breadcrumbs-f0ae94d4.js";import"./Link-359d994c.js";import"./NavbarItem-766600c9.js";import"./DropdownSearch-d54bf8fb.js";import"./Input-4c73d710.js";import"./Icon-6def3c13.js";import"./Field-e1691255.js";import"./InputFile-216a7277.js";import"./sweetalert2.all-7b2d1616.js";const ce={name:"BizFormInputColor",components:{BizFormField:I,BizInputError:w,BizInputColor:J},mixins:[X],inheritAttrs:!1,props:{disabled:{type:Boolean,default:!1},label:{type:String,default:null},message:{type:[Object,null],required:!0},modelValue:{type:[String,null],default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:t}){return{computedValue:Y(o,t)}},computed:{hasError(){return!!this.message}}};function pe(o,t,l,n,u,r){const B=i("biz-input-color"),A=i("biz-input-error"),C=i("biz-form-field");return d(),h(C,{"is-required":l.required},Z({error:m(()=>[a(A,{message:l.message},null,8,["message"])]),default:m(()=>[a(B,$({ref:"input"},o.$attrs,{modelValue:n.computedValue,"onUpdate:modelValue":t[0]||(t[0]=V=>n.computedValue=V),disabled:l.disabled,"has-error":r.hasError,placeholder:l.placeholder,required:l.required}),null,16,["modelValue","disabled","has-error","placeholder","required"])]),_:2},[l.label?{name:"label",fn:m(()=>[b(f(l.label),1)]),key:"0"}:void 0]),1032,["is-required"])}const _e=U(ce,[["render",pe]]),fe={name:"StripeSettings",components:{BizButton:T,BizCheckbox:H,BizDropdownItem:K,BizErrorNotifications:Q,BizFormDropdownSearch:R,BizFormField:I,BizFormInput:W,BizFormInputAddons:G,BizFormInputColor:_e,BizFormFile:ne,BizImage:re,BizInputError:w,BizSelect:le,BizTable:ie},mixins:[ae],layout:D,props:{amountOptions:{type:Object,default:()=>{}},applicationFeePercentage:{type:Number,default:null},colorPrimary:{type:String,default:null},colorSecondary:{type:String,default:null},countryOptions:{type:Array,required:!0},currencyOptions:{type:Array,required:!0},defaultCountry:{type:String,default:""},errors:{type:Object,default:()=>{}},isEnabled:{type:Boolean,default:!1},logoStripeUrl:{type:String,default:""},logoMimeTypes:{type:Array,default:()=>[]},logoInstructions:{type:Array,default:()=>[]},minimalAmounts:{type:Object,default:()=>{}},paymentCurrencies:{type:Array,default:()=>[]},title:{type:String,default:"Stripe"}},setup(o){const t={amount_options:o.amountOptions??{},application_fee_percentage:o.applicationFeePercentage??null,default_country:o.defaultCountry??"",is_enabled:o.isEnabled??!1,minimal_amounts:o.minimalAmounts??{},payment_currencies:o.paymentCurrencies??[],color_primary:o.colorPrimary??"",color_secondary:o.colorSecondary??"",logo:null};return{form:ee(t)}},data(){return{filteredCountries:this.countryOptions.slice(0,10),icon:me,loader:null,logoImgUrl:this.logoStripeUrl,tempAmountOptions:{}}},computed:{selectedCountry:{get(){return this.form.default_country?p.find(this.countryOptions,["id",this.form.default_country]).value:""},set(o){this.form.default_country=o.id}},hasImageLogo(){return!p.isEmpty(this.logoImgUrl)}},watch:{"form.payment_currencies":{deep:!0,handler(o,t){const l=this,n=p.difference(o,t),u=p.difference(t,o);p.forEach(n,r=>{l.form.amount_options[r]=[],l.form.minimal_amounts[r]="",l.tempAmountOptions[r]=""}),p.forEach(u,r=>{delete l.form.amount_options[r],delete l.form.minimal_amounts[r],delete l.tempAmountOptions[r]})}}},methods:{searchCountry:p.debounce(function(o){!p.isEmpty(o)&&o.length>1?this.filteredCountries=p.filter(this.countryOptions,function(t){return new RegExp(o,"i").test(t.value)}).slice(0,10):this.filteredCountries=this.countryOptions.slice(0,10)},oe),addAmount(o){this.canAddAmountOption(this.tempAmountOptions[o])&&(this.form.amount_options[o].push(parseInt(this.tempAmountOptions[o])),this.tempAmountOptions[o]="")},canAddAmountOption(o){return o&&/^\+?\d+$/.test(o.replace(/\s/g,""))&&parseInt(o)>0},deleteAmount(o,t){this.form.amount_options[o].splice(t,1)},submit(){const o=this;this.form.post(this.route("admin.settings.stripe.update"),{preserveScroll:!1,onStart:()=>{o.loader=o.$loading.show()},onSuccess:t=>{de(t.props.flash.message),o.resetFormLogo()},onError(t){ue()},onFinish:()=>{o.loader.hide()}})},onFilePicked(o){this.logoImgUrl=o.target.result},resetFormLogo(){this.form.logo=null,this.logoImgUrl=this.logoStripeUrl}}},he={class:"box mb-6"},be={class:"columns"},ye=e("div",{class:"column"},[e("h3",{class:"title is-3"}," Settings ")],-1),ge={class:"column"},ze={class:"field is-grouped is-grouped-right"},ve={class:"control"},Be={class:"columns"},Ae=e("div",{class:"column"},[e("b",null,"Is Enabled ?")],-1),Ce={class:"column"},Ve=e("option",{value:!0}," Enabled ",-1),ke=e("option",{value:!1}," Disabled ",-1),Se={class:"columns"},Oe=e("div",{class:"column"},[e("b",null,"Default Country")],-1),Fe={class:"column"},Ie={style:{"min-width":"4rem"}},we={class:"columns"},Ue=e("div",{class:"column"},[e("b",null,"Application Fee Percentage")],-1),Ee={class:"column"},Pe=e("p",{class:"control"},[e("a",{class:"button is-static"},"%")],-1),qe={class:"columns"},Me=e("div",{class:"column"},[e("b",null,"Payment Currencies")],-1),xe={class:"column"},Le={class:"control"},Ne=e("thead",null,[e("tr",null,[e("th",null,"Currency"),e("th",null,"Minimal Payment"),e("th",{colspan:"2"}," Amount Options ")])],-1),je={class:"columns is-multiline"},De={class:"column is-6"},Te={class:"control"},He=["disabled","onClick"],Ke={class:"column is-12 pt-0"},Qe={class:"tags are-medium"},Re=["onClick"],We={class:"columns"},Ge=e("div",{class:"column"},[e("b",null,"Primary Color")],-1),Je={class:"column"},Xe={class:"columns"},Ye=e("div",{class:"column"},[e("b",null,"Secondary Color")],-1),Ze={class:"column"},$e={class:"columns"},eo=e("div",{class:"column"},[e("b",null,"Logo")],-1),oo={class:"column"};function to(o,t,l,n,u,r){const B=i("biz-error-notifications"),A=i("biz-button"),C=i("biz-select"),V=i("biz-dropdown-item"),E=i("biz-form-dropdown-search"),k=i("biz-form-input-addons"),P=i("biz-checkbox"),q=i("biz-input-error"),M=i("biz-form-field"),x=i("biz-form-input"),L=i("biz-table"),S=i("biz-form-input-color"),N=i("biz-image"),j=i("biz-form-file");return d(),_("div",null,[a(B,{errors:o.$page.props.errors},null,8,["errors"]),e("div",he,[e("form",{onSubmit:t[7]||(t[7]=g((...s)=>r.submit&&r.submit(...s),["prevent"]))},[e("div",be,[ye,e("div",ge,[e("div",ze,[e("div",ve,[a(A,{class:"is-link"},{default:m(()=>[b(" Save ")]),_:1})])])])]),e("div",Be,[Ae,e("div",Ce,[a(C,{modelValue:n.form.is_enabled,"onUpdate:modelValue":t[0]||(t[0]=s=>n.form.is_enabled=s)},{default:m(()=>[Ve,ke]),_:1},8,["modelValue"])])]),e("div",Se,[Oe,e("div",Fe,[a(E,{"close-on-click":!0,message:o.error("default_country"),onSearch:t[1]||(t[1]=s=>r.searchCountry(s))},{trigger:m(()=>[e("span",Ie,f(r.selectedCountry),1)]),default:m(()=>[(d(!0),_(z,null,v(u.filteredCountries,s=>(d(),h(V,{key:s.id,onClick:y=>r.selectedCountry=s},{default:m(()=>[b(f(s.value),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["message"])])]),e("div",we,[Ue,e("div",Ee,[a(k,{modelValue:n.form.application_fee_percentage,"onUpdate:modelValue":t[2]||(t[2]=s=>n.form.application_fee_percentage=s),min:"0",type:"number","wrapper-class":"column is-half p-0",message:o.error("application_fee_percentage")},{afterInput:m(()=>[Pe]),_:1},8,["modelValue","message"])])]),e("div",qe,[Me,e("div",xe,[a(M,null,{error:m(()=>[a(q,{message:o.error("payment_currencies")},null,8,["message"])]),default:m(()=>[e("div",Le,[(d(!0),_(z,null,v(l.currencyOptions,(s,y)=>(d(),h(P,{key:y,checked:n.form.payment_currencies,"onUpdate:checked":t[3]||(t[3]=c=>n.form.payment_currencies=c),"label-class":"mr-4",value:s},{default:m(()=>[b(" Â "+f(s),1)]),_:2},1032,["checked","value"]))),128))])]),_:1}),n.form.payment_currencies.length?(d(),h(L,{key:0,class:"is-fullwidth"},{default:m(()=>[Ne,e("tbody",null,[(d(!0),_(z,null,v(n.form.payment_currencies,(s,y)=>(d(),_("tr",{key:y},[e("td",null,f(s),1),e("td",null,[a(x,{modelValue:n.form.minimal_amounts[s],"onUpdate:modelValue":c=>n.form.minimal_amounts[s]=c,type:"number",min:"1",style:{width:"5rem"}},null,8,["modelValue","onUpdate:modelValue"])]),e("td",null,[e("div",je,[e("div",De,[a(k,{modelValue:u.tempAmountOptions[s],"onUpdate:modelValue":c=>u.tempAmountOptions[s]=c,type:"number",min:"1",onKeydown:se(g(c=>r.addAmount(s),["prevent"]),["enter"])},{afterInput:m(()=>[e("p",Te,[e("button",{class:"button is-primary",type:"button",disabled:!r.canAddAmountOption(u.tempAmountOptions[s]),onClick:g(c=>r.addAmount(s),["prevent"])},[e("i",{class:te(u.icon.plusCircle)},null,2)],8,He)])]),_:2},1032,["modelValue","onUpdate:modelValue","onKeydown"])]),e("div",Ke,[e("div",Qe,[(d(!0),_(z,null,v(n.form.amount_options[s],(c,O)=>(d(),_("span",{key:O,class:"tag is-success"},[b(f(c)+" ",1),e("button",{class:"delete is-small",onClick:g(so=>r.deleteAmount(s,O),["prevent"])},null,8,Re)]))),128))])])])])]))),128))])]),_:1})):F("",!0)])]),e("div",We,[Ge,e("div",Je,[a(S,{modelValue:n.form.color_primary,"onUpdate:modelValue":t[4]||(t[4]=s=>n.form.color_primary=s),message:o.error("color_primary")},null,8,["modelValue","message"])])]),e("div",Xe,[Ye,e("div",Ze,[a(S,{modelValue:n.form.color_secondary,"onUpdate:modelValue":t[5]||(t[5]=s=>n.form.color_secondary=s),message:o.error("color_secondary")},null,8,["modelValue","message"])])]),e("div",$e,[eo,e("div",oo,[r.hasImageLogo?(d(),h(N,{key:0,class:"mb-2",style:{width:"200px",border:"1px solid #000"},src:u.logoImgUrl},null,8,["src"])):F("",!0),a(j,{modelValue:n.form.logo,"onUpdate:modelValue":t[6]||(t[6]=s=>n.form.logo=s),"accepted-types":l.logoMimeTypes,"is-name-displayed":!1,message:o.error("logo"),notes:l.logoInstructions,onOnFilePicked:r.onFilePicked},null,8,["modelValue","accepted-types","message","notes","onOnFilePicked"])])])],32)])])}const Mo=U(fe,[["render",to]]);export{Mo as default};

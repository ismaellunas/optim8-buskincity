import{M as B}from"./HasLoader-a564cfe6.js";import{M as y}from"./HasPageErrors-da5616c1.js";import{B as w}from"./Button-03e0d3fd.js";import{a as L}from"./Dropdown-034da47d.js";import{B as V}from"./DropdownSearch-eb09b8b3.js";import{B as U}from"./ImageSquare-b4e4050d.js";import{B as F}from"./Input-137492c5.js";import{B as S}from"./Image-c2b8efed.js";import{F as O}from"./FormSection-f6cee732.js";import{l as n,I as x,ah as E,C as P,z as C,u as p,q as s,r as l,o as u,k as f,i,p as m,t as g,f as D,j as q,F as k,n as T}from"./vue-loading.min-a6a947f0.js";import{s as M,o as N,c as j}from"./alert-fe3154bb.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import"./utils-caa7a80b.js";import"./Field-a8082082.js";import"./Field-e1691255.js";import"./InputError-9b7084c8.js";import"./DropdownSearch-d54bf8fb.js";import"./Input-4c73d710.js";import"./Icon-6def3c13.js";import"./icon-class-4ab3933f.js";import"./ButtonIcon-b1d1d2b0.js";import"./InputFile-216a7277.js";import"./ModalCard-06597c5e.js";import"./cropper-72988d76.js";import"./sweetalert2.all-7b2d1616.js";const H={name:"ProfileUpdateProfileInformationForm",components:{BizButton:w,BizDropdownItem:L,BizFormDropdownSearch:V,BizFormImageSquare:U,BizFormInput:F,BizImage:S,FormSection:O},mixins:[B,y],props:{languageOptions:{type:Array,default:()=>[]},user:{type:Object,required:!0}},emits:["after-update-profile"],data(){const t=n.find(this.languageOptions,["code",x().props.value.userOriginLanguage]);return{cropper:null,acceptedTypes:E,form:this.$inertia.form({_method:"PUT",first_name:this.user.first_name,last_name:this.user.last_name,email:this.user.email,photo:null,is_photo_deleted:!1,language_id:t.id??null}),photoUrl:this.user.profile_photo_url,isImageEditing:!1,filteredLanguages:this.languageOptions.slice(0,10),userImage:P}},computed:{isDeleteButtonShown(){return!n.isEmpty(this.photoUrl)&&!n.isEmpty(this.user.profile_photo_url)},selectedLanguage:{get(){if(this.form.language_id){let t=n.find(this.languageOptions,["id",parseInt(this.form.language_id)]);if(t)return t.value}return""},set(t){this.form.language_id=t.id}}},methods:{updateProfileInformation(){this.onStartLoadingOverlay(),this.form.post(route("user-profile-information.update"),{errorBag:"updateProfileInformation",preserveScroll:!0,onSuccess:()=>{this.resetImageForm(),this.$emit("after-update-profile"),M("Saved")},onError:()=>{N()},onFinish:()=>{this.onEndLoadingOverlay()}})},resetImageForm(){this.form.reset("photo","is_photo_deleted")},onDeleteImage(){const t=this;j().then(e=>{e.isConfirmed&&(t.photoUrl=null,t.form.photo=null,t.form.is_photo_deleted=!0)})},onCroppedImage(){this.form.is_photo_deleted=!1},searchLanguage:n.debounce(function(t){!n.isEmpty(t)&&t.length>1?this.filteredLanguages=n.filter(this.languageOptions,function(e){return new RegExp(t,"i").test(e.value)}).slice(0,10):this.filteredLanguages=this.languageOptions.slice(0,10)},C)}},R={class:"field is-horizontal mb-5"},G={class:"field is-horizontal mb-5"},J={class:"field-body"},K={class:"field mb-5"},Q={class:"field mb-5"},W={style:{"min-width":"4rem"}},X={class:"field mb-5"},Y=i("span",{class:"has-text-weight-bold"},"Update details",-1);function Z(t,e,_,$,o,a){const c=l("biz-image"),h=l("biz-form-image-square"),d=l("biz-form-input"),b=l("biz-dropdown-item"),I=l("biz-form-dropdown-search"),z=l("biz-button"),v=l("form-section");return u(),p(v,{onSubmitted:a.updateProfileInformation},{title:s(()=>[f(" Account Details ")]),form:s(()=>[i("div",R,[m(h,{modelValue:o.form.photo,"onUpdate:modelValue":e[0]||(e[0]=r=>o.form.photo=r),"photo-url":o.photoUrl,"onUpdate:photoUrl":e[1]||(e[1]=r=>o.photoUrl=r),label:"Profile picture","is-rounded-preview":"","modal-title":"Profile picture","wrapper-class":"field-body is-align-items-center",message:t.error("photo"),"original-image":_.user.profile_photo_url,"show-delete-button":a.isDeleteButtonShown,onOnCroppedImage:e[2]||(e[2]=r=>a.onCroppedImage()),onOnDeleteImage:e[3]||(e[3]=r=>a.onDeleteImage())},{defaultImageView:s(()=>[m(c,{ratio:"is-128x128",rounded:"is-rounded",src:o.userImage},null,8,["src"])]),_:1},8,["modelValue","photo-url","message","original-image","show-delete-button"])]),i("div",G,[i("div",J,[m(d,{modelValue:o.form.first_name,"onUpdate:modelValue":e[4]||(e[4]=r=>o.form.first_name=r),disabled:"",label:"First name",required:"",message:o.form.errors.first_name},null,8,["modelValue","message"]),m(d,{modelValue:o.form.last_name,"onUpdate:modelValue":e[5]||(e[5]=r=>o.form.last_name=r),disabled:"",label:"Last name",required:"",message:o.form.errors.last_name},null,8,["modelValue","message"])])]),i("div",K,[m(d,{modelValue:o.form.email,"onUpdate:modelValue":e[6]||(e[6]=r=>o.form.email=r),disabled:"",label:"Email",required:"",type:"email",message:o.form.errors.email},null,8,["modelValue","message"])]),i("div",Q,[m(I,{label:"Language",required:"","close-on-click":!0,message:o.form.errors.language_id,onSearch:e[7]||(e[7]=r=>a.searchLanguage(r))},{trigger:s(()=>[i("span",W,g(a.selectedLanguage),1)]),default:s(()=>[(u(!0),D(k,null,q(o.filteredLanguages,r=>(u(),p(b,{key:r.id,onClick:ee=>a.selectedLanguage=r},{default:s(()=>[f(g(r.value),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["message"])])]),actions:s(()=>[i("div",X,[m(z,{class:T([{"opacity-25":o.form.processing},"is-medium is-primary"]),disabled:o.form.processing},{default:s(()=>[Y]),_:1},8,["class","disabled"])])]),_:1},8,["onSubmitted"])}const Ve=A(H,[["render",Z]]);export{Ve as default};

import{M as x}from"./HasModal-fa56130c.js";import{B as y}from"./Button-b3acaac2.js";import{B as N}from"./Input-2fb71e37.js";import R from"./NavigationFormMenuItem-99e302bc.js";import w from"./NavigationMenu-33f27ef6.js";import{D as C}from"./vuedraggable.umd-12c8e910.js";import{I as E,l as p,u as _,q as r,n as S,r as l,o as h,i as n,p as c,s as D,E as k,G as B}from"./vue-loading.min-aa20e13d.js";import{c as z}from"./alert-e0e75cb7.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasPageErrors-4d447fdf.js";import"./utils-79a9c8b1.js";import"./Checkbox-8d9a17c8.js";import"./Input-50a73630.js";import"./Field-fbae01a6.js";import"./Field-c2e062a9.js";import"./InputError-bc1e9f36.js";import"./Select-c82d82bb.js";import"./Select-9fda6861.js";import"./ModalCard-42b1747b.js";import"./ThemeMenuItem-ff92671d.js";import"./Tag-083af5c2.js";import"./icon-class-4ab3933f.js";import"./sweetalert2.all-ebd52f41.js";const A={name:"NavigationSegment",components:{BizButton:y,BizInput:N,NavigationFormMenu:R,NavigationMenu:w,Draggable:C},mixins:[x],props:{menu:{type:Object,required:!0},menuItems:{type:Array,default:()=>{}},localeOptions:{type:Array,default:()=>{}},selectedLocale:{type:String,default:"en"}},emits:["duplicate-menu-item","edit-row","open-duplicate-modal","open-form-modal"],setup(){return{baseRouteName:E().props.value.baseRouteName??null,validationRoute:route("admin.api.theme.header.menu-item.validate")}},data(){return{menuItemErrors:{},selectedIndex:null,selectedMenuItem:{}}},computed:{panelClasses(){return{panel:!0,"pl-4":!0}}},methods:{editRow(e){this.selectedMenuItem=e,this.menuItemErrors={},this.openModal()},deleteRow(e){const t=this,o=this.menuItems;let a="";o[e].children.length>0&&(a="A menu item will deleted too."),z("Are you sure?",a).then(i=>{i.isConfirmed&&t.$emit("menu-items",o.splice(e,1))})},openFormModal(e){this.selectedMenuItem={},this.menuItemErrors={},this.selectedIndex=e,this.openModal()},openDuplicateModal(e,t){const o=p.cloneDeep(e);o.id=null,o.parent_id=null,o.children=[],o.locale=this.selectedLocale,this.$emit("open-duplicate-modal",o,t)},addMenuItem(e){const t=this;let o=t.menuItems;axios.post(t.validationRoute,e).then(()=>{o[t.selectedIndex].children.push(p.cloneDeep(e)),t.selectedIndex=null,t.closeModal()}).catch(a=>{t.menuItemErrors=a.response.data.errors})},updateMenuItem(e){const t=this;axios.post(t.validationRoute,e).then(()=>{t.updateSelectedMenu(e),t.closeModal()}).catch(o=>{t.menuItemErrors=o.response.data.errors})},updateSelectedMenu(e){this.selectedMenuItem.title=e.title,this.selectedMenuItem.type=e.type,this.selectedMenuItem.url=e.url,this.selectedMenuItem.is_blank=e.is_blank,this.selectedMenuItem.menu_itemable_id=e.menu_itemable_id}}},M=e=>(k("data-v-d9b40392"),e=e(),B(),e),O={class:"columns"},F={class:"column"},L={class:"panel-heading"},U={class:"field is-grouped"},q=M(()=>n("div",{class:"control is-align-items-center is-flex"},[n("span",{class:"panel-icon handle-segment"},[n("i",{class:"fas fa-bars","aria-hidden":"true"})])],-1)),j={class:"control is-expanded"},G={class:"control"},H=M(()=>n("span",{class:"icon has-text-danger"},[n("i",{class:"fas fa-trash","aria-hidden":"true"})],-1));function P(e,t,o,a,i,s){const I=l("biz-input"),f=l("biz-button"),g=l("navigation-menu"),v=l("navigation-form-menu"),b=l("draggable");return h(),_(b,{handle:".handle-segment","item-key":"id",animation:300,class:S(s.panelClasses),group:{name:"segment"},list:o.menuItems},{item:r(({element:d,index:u})=>[n("div",O,[n("div",F,[c(g,{"is-child":!1,"menu-items":d.children,"locale-options":o.localeOptions,"selected-locale":o.selectedLocale,"segment-index":u,onDuplicateMenuItem:s.openDuplicateModal,onEditRow:s.editRow,onOpenFormModal:s.openFormModal},{header:r(()=>[n("div",L,[n("div",U,[q,n("div",j,[c(I,{modelValue:d.title,"onUpdate:modelValue":m=>d.title=m,placeholder:"Segment Name",required:""},null,8,["modelValue","onUpdate:modelValue"])]),n("div",G,[c(f,{type:"button",class:"is-ghost",onClick:m=>s.deleteRow(u)},{default:r(()=>[H]),_:2},1032,["onClick"])])])])]),_:2},1032,["menu-items","locale-options","selected-locale","segment-index","onDuplicateMenuItem","onEditRow","onOpenFormModal"])]),e.isModalOpen?(h(),_(v,{key:0,"base-route-name":a.baseRouteName,errors:i.menuItemErrors,menu:o.menu,"menu-item":i.selectedMenuItem,"selected-locale":o.selectedLocale,onAddMenuItem:s.addMenuItem,onClose:t[0]||(t[0]=m=>e.closeModal()),onUpdateMenuItem:s.updateMenuItem},null,8,["base-route-name","errors","menu","menu-item","selected-locale","onAddMenuItem","onUpdateMenuItem"])):D("",!0)])]),_:1},8,["class","list"])}const _e=V(A,[["render",P],["__scopeId","data-v-d9b40392"]]);export{_e as default};

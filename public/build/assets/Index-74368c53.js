import{M as P}from"./FilterDataHandle-94157290.js";import{A as D}from"./AppLayout-25ccdbdb.js";import{B as R}from"./Button-b3acaac2.js";import{B as T}from"./ButtonLink-71ebb617.js";import{B as L}from"./Search-cafe34ab.js";import{B as N}from"./FlashNotifications-153d09b4.js";import{B as V}from"./TableIndex-6b2a4ef8.js";import{B as A}from"./Tag-083af5c2.js";import{i as F}from"./icon-class-4ab3933f.js";import{c as k,b as j}from"./alert-e0e75cb7.js";import{l as w,B,f as m,p as y,i as e,u as p,q as o,s as h,r as f,o as r,n as u,F as v,j as z,t as _,k as C,w as I}from"./vue-loading.min-aa20e13d.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasLoader-a564cfe6.js";import"./Breadcrumbs-0b4348b1.js";import"./Link-2bcf0cab.js";import"./utils-79a9c8b1.js";import"./NavbarItem-7e983d41.js";import"./ButtonIcon-05c24ca4.js";import"./Icon-150b61ef.js";import"./Field-c2e062a9.js";import"./Input-2fb71e37.js";import"./Pagination-8d9b0028.js";import"./Table-2efbef14.js";import"./TableInfo-c372d0e5.js";import"./sweetalert2.all-ebd52f41.js";const Q={name:"PageIndex",components:{BizButton:R,BizButtonLink:T,BizFilterSearch:L,BizFlashNotifications:N,BizTableIndex:V,BizTag:A},mixins:[P],layout:D,props:{baseRouteName:{type:String,required:!0},can:{type:Object,required:!0},defaultLocale:{type:String,required:!0},pageQueryParams:{type:Object,default:()=>{}},records:{type:Object,required:!0},title:{type:String,required:!0}},setup(t){var i;const s=w.merge({},t.pageQueryParams);return{queryParams:B(s),term:B(((i=t.pageQueryParams)==null?void 0:i.term)??null)}},data(){return{icon:F}},methods:{openShow(t,s){if(this.can.read){let i=this.getShowUrl(t,s);window.open(i,"_blank")}},statusClass(t){let s=["is-small","is-rounded"];switch(t){case 1:s.push("is-success");break;default:s.push("is-light")}return s},getShowUrl(t,s){let i=w.filter(s.translations,{locale:t}),n=null,l=route("frontend.pages.show",{page_translation:i.length?i[0].slug:s.slug}),c=new URL(l);return t!==this.defaultLocale?n=l.replace(c.pathname,"/"+t+c.pathname):n=l,n},isUsedByMenu(t){return new Promise((s,i)=>{const n=route("admin.api.pages.is-used-by-menu",{page:t});axios.get(n).then(l=>{s(l.data==!0)}).catch(l=>{i(l)})})},async canDeletePage(t){try{return await this.isUsedByMenu(t)?!!(await k("Are You Sure?","This action will also remove the page on the navigation menu.","Yes")).value:await k().then(i=>i.isConfirmed)}catch(s){return console.error(s),!0}},async deleteRow(t){const s=this;if(await s.canDeletePage(t.id)){const i=route("admin.pages.destroy",{id:t.id});s.$inertia.delete(i)}},duplicateRow(t){const s=this;j("Duplicate Page","Are you sure want to duplicate this page?").then(i=>{i.isConfirmed&&s.$inertia.post(route("admin.pages.duplicate",{id:t.id}))})}}},E={class:"box"},Y={class:"columns"},H={class:"column is-4"},G={class:"column is-4 is-offset-4 has-text-right"},J={class:"icon is-small"},K=e("span",null,"Create New",-1),W=e("tr",null,[e("th",null,"#"),e("th",null,"Title"),e("th",null,"Slug"),e("th",null,"Status"),e("th",null,"M.Title"),e("th",null,"M.Description"),e("th",null,"Language"),e("th",null,[e("div",{class:"level-right"}," Actions ")])],-1),X=["href"],Z={class:"buttons"},$={class:"level-right"},ee={class:"icon is-small"},te={class:"icon is-small"},se={class:"icon is-small"};function ie(t,s,i,n,l,c){const x=f("biz-flash-notifications"),S=f("biz-filter-search"),g=f("biz-button-link"),U=f("biz-tag"),b=f("biz-button"),q=f("biz-table-index");return r(),m("div",null,[y(x,{flash:t.$page.props.flash},null,8,["flash"]),e("div",E,[e("div",Y,[e("div",H,[y(S,{modelValue:n.term,"onUpdate:modelValue":s[0]||(s[0]=a=>n.term=a),onSearch:t.search},null,8,["modelValue","onSearch"])]),e("div",G,[i.can.add?(r(),p(g,{key:0,href:t.route("admin.pages.create"),class:"is-primary"},{default:o(()=>[e("span",J,[e("i",{class:u(l.icon.add)},null,2)]),K]),_:1},8,["href"])):h("",!0)])]),y(q,{records:i.records,"query-params":n.queryParams},{thead:o(()=>[W]),default:o(()=>[(r(!0),m(v,null,z(i.records.data,a=>(r(),m("tr",{key:a.id},[e("th",null,_(a.id),1),e("td",null,[e("a",{href:a.urlDefaultLocale,target:"_blank"},_(a.title),9,X)]),e("td",null,_(a.slug),1),e("td",null,[y(U,{class:u(c.statusClass(a.status))},{default:o(()=>[C(_(a.statusText),1)]),_:2},1032,["class"])]),e("td",null,[a.hasMetaTitle?(r(),m("i",{key:0,class:u(l.icon.checkCircle)},null,2)):h("",!0)]),e("td",null,[a.hasMetaDescription?(r(),m("i",{key:0,class:u(l.icon.checkCircle)},null,2)):h("",!0)]),e("td",null,[e("div",Z,[(r(!0),m(v,null,z(a.availableTranslations,(d,M)=>(r(),p(b,{key:M,class:"is-info px-2 mr-1 is-small",onClick:ae=>c.openShow(d,a)},{default:o(()=>[C(_(d==null?void 0:d.toUpperCase()),1)]),_:2},1032,["onClick"]))),128))])]),e("td",null,[e("div",$,[i.can.add?(r(),p(b,{key:0,class:"is-ghost has-text-black",onClick:d=>c.duplicateRow(a)},{default:o(()=>[e("span",ee,[e("i",{class:u(l.icon.copy)},null,2)])]),_:2},1032,["onClick"])):h("",!0),i.can.edit?(r(),p(g,{key:1,class:"is-ghost has-text-black",href:t.route("admin.pages.edit",{id:a.id})},{default:o(()=>[e("span",te,[e("i",{class:u(l.icon.edit)},null,2)])]),_:2},1032,["href"])):h("",!0),i.can.delete?(r(),p(b,{key:2,class:"is-ghost has-text-black ml-1",onClick:I(d=>c.deleteRow(a),["prevent"])},{default:o(()=>[e("span",se,[e("i",{class:u(l.icon.remove)},null,2)])]),_:2},1032,["onClick"])):h("",!0)])])]))),128))]),_:1},8,["records","query-params"])])])}const Me=O(Q,[["render",ie]]);export{Me as default};

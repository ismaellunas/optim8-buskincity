import{B as k}from"./ButtonIcon-b1d1d2b0.js";import B from"./ScheduleRuleTime-7016460d.js";import{i as F}from"./icon-class-4ab3933f.js";import{h as l}from"./moment-fbc5633a.js";import{l as c,f as r,F as h,j as _,x as S,s as f,r as g,o as n,i as d,p,t as V}from"./vue-loading.min-a6a947f0.js";import{u as b}from"./utils-caa7a80b.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";import"./Button-03e0d3fd.js";import"./Icon-6def3c13.js";import"./Datepicker-4f509259.js";const A={components:{BizButtonIcon:k,ScheduleRuleTime:B},props:{modelValue:{type:Array,required:!0},errorKeyPrefix:{type:String,default:""},errors:{type:Object,default:()=>{}},timeFormat:{type:String,default:"HH:mm"}},emits:["time-range-removed","time-range-added"],setup(e,{emit:i}){return{timeRanges:b(e,i),icon:F,defaultTimeRange:["09:00","17:00"]}},computed:{canAddTimeRange(){const e=c.last(this.timeRanges),i=l("23:45",this.timeFormat);return e?l(e.ended_time,this.timeFormat).isBefore(i):!0}},methods:{removeTimeRange(e){this.timeRanges.splice(e,1),this.$emit("time-range-removed")},addTimeRange(){if(this.timeRanges.length==0)this.timeRanges.push({started_time:this.defaultTimeRange[0],ended_time:this.defaultTimeRange[1]});else{const e=c.last(this.timeRanges);if(!this.canAddTimeRange)return!1;const i=l("23:45",this.timeFormat),s=l(e.ended_time,this.timeFormat);let t=s.clone().add(1,"hour"),o=s.clone().add(2,"hour");if(t.isSameOrAfter(i)&&(t=s.clone(),o=i.clone()),t.isSame(i)&&o.isSame(i))return!1;this.timeRanges.push({started_time:t.format(this.timeFormat),ended_time:o.format(this.timeFormat)})}this.$emit("time-range-added")},hasErrorByIndex(e){return!c.isEmpty(this.errors)&&this.errors[e]}}},E={class:"columns is-multiline"},C={class:"columns is-multiline"},z={class:"column is-9"},K={class:"event-time-range"},N={class:"column is-3"},P={key:0,class:"help is-danger mt-0 ml-2"},j={key:0,class:"column is-full"};function w(e,i,s,t,o,u){const R=g("schedule-rule-time"),y=g("biz-button-icon");return n(),r("div",E,[(n(!0),r(h,null,_(t.timeRanges,(v,m)=>(n(),r("div",{key:m,class:"column is-full"},[d("div",C,[d("div",z,[d("div",K,[p(R,{modelValue:t.timeRanges[m],"onUpdate:modelValue":a=>t.timeRanges[m]=a,min:v.ended_time??null},null,8,["modelValue","onUpdate:modelValue","min"])])]),d("div",N,[p(y,{type:"button",class:"is-danger",icon:t.icon.remove,onClick:a=>u.removeTimeRange(m)},null,8,["icon","onClick"])]),u.hasErrorByIndex(`${s.errorKeyPrefix}.${m}`)?(n(),r("div",P,[(n(!0),r(h,null,_(s.errors[`${s.errorKeyPrefix}.${m}`],(a,T)=>(n(),r("div",{key:T},V(a),1))),128))])):f("",!0)])]))),128)),t.timeRanges.length==0?(n(),r("div",j,[S(e.$slots,"emptyTimeRange")])):f("",!0)])}const J=x(A,[["render",w]]);export{J as default};

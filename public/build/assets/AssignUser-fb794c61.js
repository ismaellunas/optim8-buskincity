import{B as v}from"./DropdownSearch-eb09b8b3.js";import{a as k}from"./Dropdown-034da47d.js";import{l as u,z as w,r as m,o as t,f as n,p as x,q as d,F as h,j as p,u as y,k as U,t as f,m as B,y as z,i as l}from"./vue-loading.min-a6a947f0.js";import{u as I}from"./utils-caa7a80b.js";import{_ as C}from"./_plugin-vue_export-helper-c27b6911.js";const S={components:{BizDropdownItem:k,BizFormDropdownSearch:v},props:{modelValue:{type:Array,default:()=>[]},label:{type:String,default:"Choose User"},getUsersUrl:{type:String,required:!0}},setup(e,{emit:r}){return{currentUsers:I(e,r)}},data(){return{filteredUsers:[],term:null}},computed:{userIds(){return this.currentUsers.map(e=>e.id)},userOptions(){return this.filteredUsers.filter(e=>!this.userIds.includes(e.id))}},mounted(){this.getUsers(null,this.userIds)},methods:{getUsers(e,r){const a=this,i=this.getUsersUrl;axios.get(i,{params:{term:e,excluded:r}}).then(c=>{a.filteredUsers=c.data})},searchUser:u.debounce(function(e){this.term=e,this.getUsers(e,this.userIds)},w),addUser(e){this.userIds.includes(e.id)||this.currentUsers.push(e)},removeUser(e){this.userIds.includes(e.id)&&(u.remove(this.currentUsers,r=>r.id==e.id),this.currentUsers.length<=0&&this.getUsers(this.term,this.userIds))}}},D=l("span",{style:{"min-width":"4rem"}}," Search ",-1),F={class:"box"},V=["onClick"];function N(e,r,a,i,c,o){const _=m("biz-dropdown-item"),g=m("biz-form-dropdown-search");return t(),n("div",null,[x(g,{"close-on-click":!0,label:a.label,onSearch:r[0]||(r[0]=s=>o.searchUser(s))},{trigger:d(()=>[D]),default:d(()=>[(t(!0),n(h,null,p(o.userOptions,s=>(t(),y(_,{key:s.id,onClick:b=>o.addUser(s)},{default:d(()=>[U(f(s.value),1)]),_:2},1032,["onClick"]))),128))]),_:1},8,["label"]),B(l("div",F,[(t(!0),n(h,null,p(i.currentUsers,s=>(t(),n("span",{key:s.id,class:"tag is-medium mx-1"},[U(f(s.value)+" ",1),l("button",{class:"delete is-small",onClick:b=>o.removeUser(s)},null,8,V)]))),128))],512),[[z,i.currentUsers.length>0]])])}const j=C(S,[["render",N]]);export{j as B};

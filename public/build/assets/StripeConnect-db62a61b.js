import{M as S}from"./HasLoader-a564cfe6.js";import{M as x}from"./HasPageErrors-da5616c1.js";import{L as B}from"./User-b709320f.js";import{B as O}from"./Button-03e0d3fd.js";import{B as F}from"./Select-a178b677.js";import{B as P}from"./Table-6b0ddb68.js";import{b as A,o as b,s as T}from"./alert-fe3154bb.js";import{H as C,B as k,l as E,f as a,i as e,p as d,q as l,u as w,w as V,s as h,r as g,o,F as y,j as p,t as c}from"./vue-loading.min-a6a947f0.js";import{i as L}from"./utils-caa7a80b.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import"./Link-359d994c.js";import"./NavbarItem-766600c9.js";import"./Field-a8082082.js";import"./Field-e1691255.js";import"./InputError-9b7084c8.js";import"./Select-19a91b6e.js";import"./sweetalert2.all-7b2d1616.js";const z={components:{BizButton:O,BizFormSelect:F,BizTable:P},mixins:[S,x],layout:(t,i)=>t(B,()=>i),props:{hasConnectedAccount:{type:Boolean,required:!0},hasPassedOnboarding:{type:Boolean,required:!0},errors:{type:Object,default:()=>{}},title:{type:String,default:"Stripe Connect"},balance:{type:Object,default:()=>{}},balanceTransactions:{type:Object,default:()=>{}},countryOptions:{type:Object,default:()=>{}},defaultCountry:{type:String,default:null},isEnabled:{type:Boolean,default:!1},pageQueryParams:{type:Object,default:null}},setup(t){const i={country:t.defaultCountry},n={is_enabled:t.isEnabled};return{createStripeForm:C(i),loader:k(null),settingForm:C(n),queryParams:k(E.merge({},t.pageQueryParams))}},data(){return{baseUrl:route("payments.stripe.show")}},computed:{isPreviousDisabled(){return!(this.queryParams.startingAfter||this.queryParams.endingBefore&&this.balanceTransactions.has_more==!0)},isNextDisabled(){return!(this.queryParams.endingBefore||this.queryParams.startingAfter&&this.balanceTransactions.has_more==!0||L(this.queryParams)&&this.balanceTransactions.has_more==!0)}},methods:{createConnectedAccount(){const t=this,i=route("payments.stripe.create-connected-account");A("Please double-check your country!","You will not be able to change your country in the future.","Continue").then(n=>{n.isConfirmed&&t.createStripeForm.post(i,{replace:!0,preserveState:!0,onStart:()=>t.onStartLoadingOverlay(),onFinish:()=>t.onEndLoadingOverlay(),onError:u=>{b()}})})},async redirectToStripe(){this.onStartLoadingOverlay();try{const t=await axios.get(route("payments.stripe.redirect-to-stripe"));window.open(t.data.url)}catch{b()}this.onEndLoadingOverlay()},async redirectToOnboardingAccount(){this.onStartLoadingOverlay();try{const t=await axios.get(route("payments.stripe.account-link"));window.open(t.data.url)}catch(t){console.error(t),b()}this.onEndLoadingOverlay()},submit(){this.settingForm.post(route("payments.stripe.update-setting"),{onStart:()=>{this.loader=this.$loading.show()},onSuccess:t=>{T(t.props.flash.message)},onError(t){b()},onFinish:()=>{this.loader.hide()}})},paginationVisit(t){this.$inertia.get(t,{},{preserveScroll:!0,onStart:()=>{this.loader=this.$loading.show()},onFinish:()=>{this.loader.hide()}})}}},D={class:"columns is-multiline"},N={key:0,class:"column is-12"},j={class:"box is-shadowless"},U=["value"],M={class:"control"},H=e("span",{class:"has-text-weight-bold"},"Create Connected Account",-1),Q={key:1,class:"column is-12"},I={class:"box is-shadowless"},Y={class:"control"},G=e("span",{class:"has-text-weight-bold"},"Login To Stripe",-1),J=e("span",{class:"has-text-weight-bold"},"Continue Onboarding Process",-1),K={key:2,class:"column is-12"},R={class:"box is-shadowless"},W=e("h2",{class:"title is-3"}," Setting ",-1),X=e("option",{value:!0}," Enabled ",-1),Z=e("option",{value:!1}," Disabled ",-1),$={class:"field is-grouped is-grouped-left"},ee={class:"control"},te=e("span",{class:"has-text-weight-bold"},"Update",-1),se={key:3,class:"column is-12"},oe={class:"box is-shadowless"},ne=e("h2",{class:"title is-3"}," Balances ",-1),ae={key:0,class:"mb-4"},ie=e("h2",{class:"subtitle"}," Available ",-1),re=e("tr",null,[e("th",null,"Currency"),e("th",null,"Amount")],-1),le={key:1,class:"mb-4"},ce=e("h2",{class:"subtitle"}," Pending ",-1),de=e("tr",null,[e("th",null,"Currency"),e("th",null,"Amount")],-1),ue={key:4,class:"column is-12"},me={class:"box is-shadowless"},he=e("h1",{class:"title"}," Transactions ",-1),_e={key:0,class:"mb-4"},be=e("tr",null,[e("th",null,"Currency"),e("th",null,"Amount"),e("th",null,"Date")],-1),ye={class:"pagination",role:"navigation","aria-label":"pagination"},pe=["disabled"],fe=["disabled"],ge={key:1,class:"mb-4"},ve=e("p",null,"No transactions",-1),Ce=[ve];function ke(t,i,n,u,we,r){const v=g("biz-form-select"),_=g("biz-button"),f=g("biz-table");return o(),a("div",null,[e("div",D,[n.hasConnectedAccount?(o(),a("div",Q,[e("div",I,[e("div",Y,[n.hasPassedOnboarding?(o(),w(_,{key:0,class:"is-medium is-primary",type:"button",onClick:r.redirectToStripe},{default:l(()=>[G]),_:1},8,["onClick"])):(o(),w(_,{key:1,class:"is-medium is-primary",type:"button",onClick:r.redirectToOnboardingAccount},{default:l(()=>[J]),_:1},8,["onClick"]))])])])):(o(),a("div",N,[e("div",j,[d(v,{modelValue:u.createStripeForm.country,"onUpdate:modelValue":i[0]||(i[0]=s=>u.createStripeForm.country=s),label:"Country",message:t.error("country")},{default:l(()=>[(o(!0),a(y,null,p(n.countryOptions,s=>(o(),a("option",{key:s.id,value:s.id},c(s.value),9,U))),128))]),_:1},8,["modelValue","message"]),e("div",M,[d(_,{class:"is-medium is-primary",onClick:r.createConnectedAccount},{default:l(()=>[H]),_:1},8,["onClick"])])])])),n.hasConnectedAccount?(o(),a("div",K,[e("div",R,[W,e("form",{onSubmit:i[2]||(i[2]=V((...s)=>r.submit&&r.submit(...s),["prevent"]))},[d(v,{modelValue:u.settingForm.is_enabled,"onUpdate:modelValue":i[1]||(i[1]=s=>u.settingForm.is_enabled=s),label:"Is Enabled ?",message:t.error("is_enabled")},{default:l(()=>[X,Z]),_:1},8,["modelValue","message"]),e("div",$,[e("div",ee,[d(_,{class:"is-medium is-primary"},{default:l(()=>[te]),_:1})])])],32)])])):h("",!0),n.hasConnectedAccount?(o(),a("div",se,[e("div",oe,[ne,n.balance.available?(o(),a("div",ae,[ie,d(f,{class:"is-bordered is-hoverable is-fullwidth"},{default:l(()=>[re,(o(!0),a(y,null,p(n.balance.available,(s,m)=>(o(),a("tr",{key:m},[e("td",null,c(s.currency.toUpperCase()),1),e("td",null,c(s.amount/100),1)]))),128))]),_:1})])):h("",!0),n.balance.pending?(o(),a("div",le,[ce,d(f,{class:"is-bordered is-hoverable is-fullwidth"},{default:l(()=>[de,(o(!0),a(y,null,p(n.balance.pending,(s,m)=>(o(),a("tr",{key:m},[e("td",null,c(s.currency.toUpperCase()),1),e("td",null,c(s.amount/100),1)]))),128))]),_:1})])):h("",!0)])])):h("",!0),n.hasConnectedAccount?(o(),a("div",ue,[e("div",me,[he,n.balanceTransactions.data.length>0?(o(),a("div",_e,[d(f,{class:"is-bordered is-hoverable is-fullwidth"},{default:l(()=>[be,(o(!0),a(y,null,p(n.balanceTransactions.data,(s,m)=>(o(),a("tr",{key:m},[e("td",null,c(s.currency),1),e("td",null,c(s.amount),1),e("td",null,c(s.created),1)]))),128))]),_:1}),e("nav",ye,[e("button",{class:"pagination-previous button",disabled:r.isPreviousDisabled,onClick:i[3]||(i[3]=s=>r.paginationVisit(n.balanceTransactions.previous_url))}," Previous ",8,pe),e("button",{class:"pagination-next button",disabled:r.isNextDisabled,onClick:i[4]||(i[4]=s=>r.paginationVisit(n.balanceTransactions.next_url))}," Next page ",8,fe)])])):(o(),a("div",ge,Ce))])])):h("",!0)])])}const Me=q(z,[["render",ke]]);export{Me as default};

import{B as D}from"./ButtonLink-71ebb617.js";import{B as E}from"./Checkbox-8d9a17c8.js";import{B as N,a as O}from"./Dropdown-5425ae3a.js";import{B as U}from"./DropdownSearch-bd4068c6.js";import{B as T}from"./DateRange-7ae8c660.js";import{B as A}from"./Input-2fb71e37.js";import{B as F}from"./Loader-5695d04b.js";import{B as j,a as q}from"./PanelBlock-876eebcb.js";import{B as I}from"./Table-2efbef14.js";import{i as P}from"./icon-class-4ab3933f.js";import{l as p,z as B,r as a,o as d,f as m,p as n,q as i,i as e,t as r,w as K,n as M,F as b,j as y,u as z,k as h,s as W}from"./vue-loading.min-aa20e13d.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import"./Link-2bcf0cab.js";import"./Button-b3acaac2.js";import"./utils-79a9c8b1.js";import"./Icon-150b61ef.js";import"./Datepicker-847140ac.js";import"./moment-fbc5633a.js";const H={name:"LatestBookingWidget",components:{BizButtonLink:D,BizCheckbox:E,BizDropdown:N,BizDropdownItem:O,BizDropdownSearch:U,BizFilterDateRange:T,BizInput:A,BizLoader:F,BizPanel:j,BizPanelBlock:q,BizTable:I},props:{data:{type:Object,required:!0},title:{type:String,default:""}},data(){return{isLoading:!1,icon:P,records:[],search:{term:null,statuses:[],city:null},filteredCities:this.data.cityOptions.slice(0,10),dates:[]}},computed:{isRecordsEmpty(){return this.records.length==0},totalStatusSelected(){return this.search.statuses.length}},mounted(){this.getRecords()},methods:{getRecords(){const l=this;l.isLoading=!0,axios.get(route("api.booking.widget.latest-bookings"),{params:{term:l.search.term,status:l.search.statuses,city:l.search.city,dates:l.dates.filter(Boolean)}}).then(s=>{l.records=s.data.records}).then(()=>{l.isLoading=!1})},onSearch:p.debounce(function(l=""){(l.length>2||l.length==0)&&this.getRecords()},B),searchCity:p.debounce(function(l){!p.isEmpty(l)&&l.length>1?this.filteredCities=p.filter(this.data.cityOptions,function(s){return new RegExp(l,"i").test(s)}).slice(0,10):this.filteredCities=this.data.cityOptions.slice(0,10)},B),onCityChange(l=null){this.search.city=l,this.getRecords()}}},J={class:"column is-full"},Q={class:"columns"},X={class:"column"},Y={class:"field is-grouped is-grouped-multiline"},Z={class:"control"},$={class:"control"},ee={class:"icon is-small"},te={class:"control"},se={class:"control"},le={class:"table-container",style:{width:"100%"}},ie=e("thead",null,[e("tr",null,[e("th",null,"Status"),e("th",null,"Name"),e("th",null,"User"),e("th",null,"Date"),e("th",null,"Time"),e("th",null,"City"),e("th",null," ")])],-1),oe={key:0},ne=e("td",{class:"has-text-centered",colspan:"7"}," Empty ",-1),ae=[ne],re={class:"level",style:{width:"100%"}},de=e("div",{class:"level-left"},null,-1),ce={class:"level-right"};function ue(l,s,_,me,o,c){const v=a("biz-loader"),w=a("biz-input"),C=a("biz-checkbox"),f=a("biz-dropdown-item"),V=a("biz-dropdown"),x=a("biz-dropdown-search"),S=a("biz-filter-date-range"),g=a("biz-panel-block"),k=a("biz-button-link"),R=a("biz-table"),L=a("biz-panel");return d(),m("div",J,[n(L,{class:"is-white is-relative"},{heading:i(()=>[e("div",Q,[e("div",X,r(_.title),1)])]),default:i(()=>[n(v,{modelValue:o.isLoading,"onUpdate:modelValue":s[0]||(s[0]=t=>o.isLoading=t),"is-full-page":!1},null,8,["modelValue"]),n(g,null,{default:i(()=>[e("div",Y,[e("div",Z,[n(w,{modelValue:o.search.term,"onUpdate:modelValue":s[1]||(s[1]=t=>o.search.term=t),class:"is-small",placeholder:"Search...",maxlength:"255",onKeyup:s[2]||(s[2]=K(t=>c.onSearch(o.search.term),["prevent"]))},null,8,["modelValue"])]),e("div",$,[n(V,{"close-on-click":!1,"class-button":"is-small"},{trigger:i(()=>[e("span",null,"Status ("+r(c.totalStatusSelected)+")",1),e("span",ee,[e("i",{class:M(o.icon.angleDown),"aria-hidden":"true"},null,2)])]),default:i(()=>[(d(!0),m(b,null,y(_.data.statusOptions,t=>(d(),z(f,{key:t.id},{default:i(()=>[n(C,{checked:o.search.statuses,"onUpdate:checked":s[3]||(s[3]=u=>o.search.statuses=u),value:t.id,onChange:s[4]||(s[4]=u=>c.getRecords())},{default:i(()=>[h("   "+r(t.value),1)]),_:2},1032,["checked","value"])]),_:2},1024))),128))]),_:1})]),e("div",te,[n(x,{"is-small":"","close-on-click":!0,onSearch:s[6]||(s[6]=t=>c.searchCity(t))},{trigger:i(()=>[e("span",null,r(o.search.city??"Any"),1)]),default:i(()=>[n(f,{onClick:s[5]||(s[5]=t=>c.onCityChange())},{default:i(()=>[h(" Any ")]),_:1}),(d(!0),m(b,null,y(o.filteredCities,(t,u)=>(d(),z(f,{key:u,onClick:he=>c.onCityChange(t)},{default:i(()=>[h(r(t),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),e("div",se,[n(S,{modelValue:o.dates,"onUpdate:modelValue":[s[7]||(s[7]=t=>o.dates=t),s[8]||(s[8]=t=>c.getRecords())],class:"dashboard-widget-datepicker","input-class-name":"input is-small","max-range":"31",style:{width:"210px"}},null,8,["modelValue"])])])]),_:1}),n(g,null,{default:i(()=>[e("div",le,[n(R,{"is-fullwidth":""},{default:i(()=>[ie,e("tbody",null,[c.isRecordsEmpty?(d(),m("tr",oe,ae)):(d(!0),m(b,{key:1},y(o.records,(t,u)=>(d(),m("tr",{key:u},[e("td",null,r(t.status),1),e("td",null,r(t.product_name),1),e("td",null,r(t.customer_name),1),e("td",null,r(t.date),1),e("td",null,r(t.start_end_time),1),e("td",null,r(t.city??"-"),1),e("td",null,[t.can.read?(d(),z(k,{key:0,class:"is-primary is-outlined is-small",title:"Detail",href:l.route(_.data.baseRouteName+".show",t.id)},{default:i(()=>[h(" View Detail ")]),_:2},1032,["href"])):W("",!0)])]))),128))])]),_:1})])]),_:1}),n(g,null,{default:i(()=>[e("div",re,[de,e("div",ce,[n(k,{class:"is-primary is-outlined is-small",href:l.route(_.data.baseRouteName+".index")},{default:i(()=>[h(" View All ")]),_:1},8,["href"])])])]),_:1})]),_:1})])}const Ee=G(H,[["render",ue]]);export{Ee as default};

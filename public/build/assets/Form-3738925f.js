import{M as V}from"./HasModal-fa56130c.js";import{B as T}from"./Button-03e0d3fd.js";import{B as M}from"./ButtonIcon-b1d1d2b0.js";import{B as x}from"./ButtonLink-abb08373.js";import{B as O}from"./LanguageTab-ce3e8bfb.js";import{B as j}from"./Select-a178b677.js";import{B as F}from"./ModalCard-06597c5e.js";import{B as N,a as A}from"./Tabs-f6aab556.js";import{F as R}from"./FormBuilder-2690236c.js";import q from"./FormDetail-a9a0c7f5.js";import E from"./FormSetting-16b7afea.js";import{B as v,I as h,l as H,f,i as n,p as s,q as a,s as g,x as W,w as G,u as _,r,o as m,k as c,t as w,F as J,j as K}from"./vue-loading.min-a6a947f0.js";import{i as B,u as y}from"./utils-caa7a80b.js";import{p as Q}from"./icon-class-4ab3933f.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import"./Icon-6def3c13.js";import"./Link-359d994c.js";import"./Field-a8082082.js";import"./Field-e1691255.js";import"./InputError-9b7084c8.js";import"./Select-19a91b6e.js";import"./Card-64180043.js";import"./TRBLInput-8cbbcf29.js";import"./Checkbox-8f917da5.js";import"./Input-137492c5.js";import"./Input-4c73d710.js";import"./NumberAddons-1b722e6e.js";import"./Number-91e213dc.js";import"./FieldHorizontal-bfc51f07.js";import"./style-options-cda219e9.js";import"./alert-fe3154bb.js";import"./sweetalert2.all-7b2d1616.js";import"./MediaTextEditor-a29275ff.js";import"./MediaLibrary-02fe4347.js";import"./HasLoader-a564cfe6.js";import"./HasPageErrors-da5616c1.js";import"./ButtonsDisplayView-20deee35.js";import"./Dropdown-034da47d.js";import"./Search-4389f740.js";import"./Image-c2b8efed.js";import"./InputFile-216a7277.js";import"./Gallery-86a7e0a4.js";import"./ButtonDownload-7545f1b2.js";import"./Modal-655bec1f.js";import"./Table-6b0ddb68.js";import"./cropper-72988d76.js";import"./Pagination-c4350b04.js";import"./TableInfo-6db2c6af.js";import"./Form-7bfdff43.js";import"./ErrorNotifications-090d6193.js";import"./Textarea-0e8af5bc.js";import"./Textarea-fb59ae31.js";import"./fontawesome-brand-classes-8350be4e.js";import"./DropdownSearch-eb09b8b3.js";import"./DropdownSearch-d54bf8fb.js";import"./vuedraggable.umd-d7851836.js";import"./ToolbarContent-b501238f.js";import"./EditorTinymce-3bb5766f.js";import"./Slug-e3370d8d.js";import"./InputAddons-7c9a4924.js";const Y={name:"PageForm",components:{BizButton:T,BizButtonIcon:M,BizButtonLink:x,BizLanguageTab:O,BizFormSelect:j,BizModalCard:F,BizProvideInjectTab:N,BizProvideInjectTabs:A,FormBuilder:R,FormDetail:q,FormSetting:E},mixins:[V],inject:["can"],provide(){return{dataImages:this.images}},props:{contentConfigId:{type:String,required:!0},emptyPageLocaleOptions:{type:Array,default:()=>[]},errors:{type:Object,default:()=>{}},isDirty:{type:Boolean,default:!1},isNew:{type:Boolean,required:!0},isPageBuilderRendered:{type:Boolean,default:!0},isPageSettingRendered:{type:Boolean,default:!0},localeOptions:{type:Array,default:()=>[]},modelValue:{type:Object,required:!0},pagePreview:{type:Boolean,default:!1},pagePreviewUrl:{type:String,default:null},selectedLocale:{type:String,required:!0},statusOptions:{type:Array,default:()=>[]},tabActive:{type:[Boolean,null,String],default:null}},emits:["on-change-locale","on-delete-translation","on-duplicate-translation","on-submit","update:contentConfigId"],setup(i,{emit:e}){let l=null;!B(i.tabActive)&&i.tabActive==="builder"?l=v(1):l=v(0);const o=h().props.value.images;return{activeTab:l,form:y(i,e),computedContentConfigId:y(i,e,"contentConfigId"),defaultLocale:h().props.value.defaultLanguage,images:B(o)?{}:o,iconPreview:Q}},data(){return{disableInput:!1,formDuplicate:{to:null}}},computed:{canPreview(){return this.can.page.read&&this.form.id&&!this.isDirty},deleteTranslationIsShowed(){var i,e,l;return this.defaultLocale!==this.selectedLocale&&((i=this.form)==null?void 0:i.id)&&((l=(e=this.can)==null?void 0:e.page)==null?void 0:l.delete)},duplicateTranslationIsShowed(){var i;return!!((i=this.form)!=null&&i.id)}},methods:{openShow(i){let e=this.pagePreviewUrl??this.getShowUrl(this.selectedLocale,i);window.open(e,"_blank")},getShowUrl(i,e){let l=null,o=route("frontend.pages.show",{page_translation:e.slug}),d=new URL(o);return i!==this.defaultLocale?l=o.replace(d.pathname,"/"+i+d.pathname):l=o,l},onChangeLocale(i){this.$emit("on-change-locale",i)},onDuplicateTranslation(){this.formDuplicate.to&&(this.images[this.formDuplicate.to]=H.cloneDeep(this.images[this.selectedLocale]),this.$emit("on-duplicate-translation",{locale:this.formDuplicate.to,form:{id:null,title:this.form.title,slug:this.form.slug,excerpt:this.form.excerpt,data:this.form.data,meta_description:this.form.meta_description,meta_title:this.form.meta_title,status:0,settings:this.form.settings}}),this.closeModal(),this.formDuplicate.to=null)},onCloseModal(){this.formDuplicate.to=null}}},Z={key:0,class:"columns"},$={class:"column"},ee={class:"buttons is-right"},te=n("span",null,"Page Preview",-1),oe={class:"columns my-0"},ie={class:"column py-0"},le={class:"mb-5"},ne={class:"columns"},ae={class:"column"},se={class:"buttons"},re={class:"column"},de={class:"buttons is-pulled-right"},me=n("p",{class:"modal-card-title has-text-weight-bold"}," Duplicate Translation ",-1),ue=n("option",{value:null}," - Select Translation - ",-1),ce=["value"],pe={class:"columns mx-0",style:{width:"100%"}},fe={class:"column px-0"},ge={class:"is-pulled-right"};function be(i,e,l,o,d,u){const C=r("biz-button-icon"),k=r("biz-language-tab"),z=r("form-detail"),b=r("biz-provide-inject-tab"),L=r("form-builder"),D=r("form-setting"),P=r("biz-provide-inject-tabs"),p=r("biz-button"),S=r("biz-button-link"),U=r("biz-form-select"),I=r("biz-modal-card");return m(),f("div",null,[l.pagePreview?(m(),f("div",Z,[n("div",$,[n("p",ee,[s(C,{icon:o.iconPreview,disabled:!u.canPreview,onClick:e[0]||(e[0]=t=>u.openShow(l.modelValue))},{default:a(()=>[te]),_:1},8,["icon","disabled"])])])])):g("",!0),n("div",oe,[n("div",ie,[s(k,{class:"is-right","locale-options":l.localeOptions,"selected-locale":l.selectedLocale,onOnChangeLocale:u.onChangeLocale},null,8,["locale-options","selected-locale","onOnChangeLocale"])])]),n("form",{method:"post",onSubmit:e[13]||(e[13]=G(t=>i.$emit("on-submit"),["prevent"]))},[n("div",le,[s(P,{modelValue:o.activeTab,"onUpdate:modelValue":e[10]||(e[10]=t=>o.activeTab=t),class:"is-boxed"},{default:a(()=>[s(b,{title:"Details"},{default:a(()=>[s(z,{title:o.form.title,"onUpdate:title":e[1]||(e[1]=t=>o.form.title=t),slug:o.form.slug,"onUpdate:slug":e[2]||(e[2]=t=>o.form.slug=t),excerpt:o.form.excerpt,"onUpdate:excerpt":e[3]||(e[3]=t=>o.form.excerpt=t),"meta-description":o.form.meta_description,"onUpdate:metaDescription":e[4]||(e[4]=t=>o.form.meta_description=t),"meta-title":o.form.meta_title,"onUpdate:metaTitle":e[5]||(e[5]=t=>o.form.meta_title=t),status:o.form.status,"onUpdate:status":e[6]||(e[6]=t=>o.form.status=t),"disable-input":d.disableInput,errors:l.errors,"selected-locale":l.selectedLocale,"status-options":l.statusOptions},null,8,["title","slug","excerpt","meta-description","meta-title","status","disable-input","errors","selected-locale","status-options"])]),_:1}),s(b,{title:"Builder","is-rendered":l.isPageBuilderRendered},{default:a(()=>[s(L,{id:"page-form-builder",modelValue:o.form.data,"onUpdate:modelValue":e[7]||(e[7]=t=>o.form.data=t),"content-config-id":o.computedContentConfigId,"onUpdate:contentConfigId":e[8]||(e[8]=t=>o.computedContentConfigId=t),"selected-locale":l.selectedLocale},null,8,["modelValue","content-config-id","selected-locale"])]),_:1},8,["is-rendered"]),s(b,{title:"Settings","is-rendered":l.isPageSettingRendered},{default:a(()=>[s(D,{modelValue:o.form.settings,"onUpdate:modelValue":e[9]||(e[9]=t=>o.form.settings=t),errors:l.errors,"selected-locale":l.selectedLocale},null,8,["modelValue","errors","selected-locale"])]),_:1},8,["is-rendered"])]),_:1},8,["modelValue"])]),W(i.$slots,"action",{isNew:l.isNew},()=>[n("div",ne,[n("div",ae,[n("div",se,[u.duplicateTranslationIsShowed?(m(),_(p,{key:0,type:"button",class:"is-link",onClick:e[11]||(e[11]=t=>i.openModal())},{default:a(()=>[c(" Duplicate ")]),_:1})):g("",!0),u.deleteTranslationIsShowed?(m(),_(p,{key:1,type:"button",class:"is-danger",onClick:e[12]||(e[12]=t=>i.$emit("on-delete-translation"))},{default:a(()=>[c(" Remove ")]),_:1})):g("",!0)])]),n("div",re,[n("div",de,[s(S,{class:"is-link is-light",href:i.route("admin.pages.index")},{default:a(()=>[c(" Cancel ")]),_:1},8,["href"]),s(p,{class:"is-link"},{default:a(()=>[c(w(l.isNew?"Create":"Update"),1)]),_:1})])])])])],32),i.isModalOpen?(m(),_(I,{key:1,onClose:e[18]||(e[18]=t=>i.closeModal())},{header:a(()=>[me,n("button",{"aria-label":"close",class:"delete",onClick:e[14]||(e[14]=t=>i.closeModal())})]),footer:a(()=>[n("div",pe,[n("div",fe,[n("div",ge,[s(p,{onClick:e[16]||(e[16]=t=>i.closeModal())},{default:a(()=>[c(" Cancel ")]),_:1}),s(p,{class:"is-link",disabled:!d.formDuplicate.to,onClick:e[17]||(e[17]=t=>u.onDuplicateTranslation())},{default:a(()=>[c(" Duplicate ")]),_:1},8,["disabled"])])])])]),default:a(()=>[s(U,{modelValue:d.formDuplicate.to,"onUpdate:modelValue":e[15]||(e[15]=t=>d.formDuplicate.to=t),label:"To","is-fullwidth":!0},{default:a(()=>[ue,(m(!0),f(J,null,K(l.emptyPageLocaleOptions,t=>(m(),f("option",{key:t.id,value:t.id},w(t.name),9,ce))),128))]),_:1},8,["modelValue"])]),_:1})):g("",!0)])}const Ct=X(Y,[["render",be]]);export{Ct as default};

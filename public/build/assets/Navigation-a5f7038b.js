import{M}from"./HasModal-fa56130c.js";import{B as v}from"./Button-03e0d3fd.js";import{B as F}from"./LanguageTab-ce3e8bfb.js";import b from"./NavigationFormDuplicate-f84f4b98.js";import y from"./NavigationSegment-bae45345.js";import{i as L}from"./icon-class-4ab3933f.js";import{I as m,l,H as D,f as S,i as o,p as u,q as x,u as C,s as O,r,o as c,n as N,k as I}from"./vue-loading.min-a6a947f0.js";import{a as d,s as k}from"./alert-fe3154bb.js";import{_ as B}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasPageErrors-da5616c1.js";import"./utils-caa7a80b.js";import"./Checkbox-8f917da5.js";import"./Input-137492c5.js";import"./Field-a8082082.js";import"./Field-e1691255.js";import"./Input-4c73d710.js";import"./InputError-9b7084c8.js";import"./Select-a178b677.js";import"./Select-19a91b6e.js";import"./ModalCard-06597c5e.js";import"./NavigationFormMenuItem-1addcf82.js";import"./NavigationMenu-8d2c1fae.js";import"./vuedraggable.umd-d7851836.js";import"./ThemeMenuItem-be410961.js";import"./Tag-8100534e.js";import"./sweetalert2.all-7b2d1616.js";const E={name:"ThemeFooterNavigation",components:{BizButton:v,BizLanguageTab:F,NavigationFormDuplicate:b,NavigationSegment:y},mixins:[M],props:{menu:{type:Object,required:!0},footerMenus:{type:Object,default:()=>{}},title:{type:String,default:"-"}},setup(){return{baseRouteName:m().props.value.baseRouteName??null,defaultLocale:m().props.value.defaultLanguage,localeOptions:m().props.value.languageOptions??[],tabs:{layout:{title:"Layout"},navigation:{title:"Navigation"}},icon:L}},data(){return{activeTab:"navigation",isModalDuplicateOpen:!1,loader:null,menuForm:{},menuItemErrors:{},segmentIndex:null,selectedLocale:this.defaultLocale,selectedMenuItem:{},validationRoute:route("admin.api.theme.header.menu-item.validate"),emptySegment:{id:null,children:[],is_blank:!1,menu_id:this.menu.id,order:null,title:null,type:m().props.value.typeSegment,url:null}}},computed:{hasMaxSegment(){var e;return((e=this.menuForm.menu_items)==null?void 0:e.length)>=4}},mounted(){this.menuForm=this.getMenuForm(this.selectedLocale)},methods:{isFormDirty(){return this.menuForm.isDirty},getMenuForm(e){const t=[l.cloneDeep(this.emptySegment)];return D({locale:e,menu_items:l.cloneDeep(l.isEmpty(this.footerMenus)||l.isEmpty(this.footerMenus[e])?t:this.footerMenus[e])})},onChangeLocale(e){this.menuForm.isDirty?d().then(t=>{if(t.isDismissed)return!1;t.isConfirmed&&(this.selectedLocale=e,this.menuForm.reset(),this.menuForm=this.getMenuForm(e))}):(this.selectedLocale=e,this.menuForm=this.getMenuForm(e))},addSegment(){this.hasMaxSegment||this.menuForm.menu_items.push(l.cloneDeep(this.emptySegment))},openDuplicateModal(e,t){this.selectedMenuItem=e,this.segmentIndex=t,this.menuItemErrors={},this.openModal()},onCloseModal(){this.selectedMenuItem={},this.menuItemErrors={}},duplicateMenuItem(e){const t=this;axios.post(t.validationRoute,e).then(()=>{t.menuForm.isDirty&&t.selectedLocale!==e.locale?d().then(s=>{if(s.isDismissed)return!1;s.isConfirmed&&(t.selectedLocale=e.locale,t.menuForm=t.getMenuForm(e.locale),t.menuForm.menu_items[0].children.push(e),t.closeModal())}):(t.selectedLocale!==e.locale?(t.selectedLocale=e.locale,t.menuForm=t.getMenuForm(e.locale),t.menuForm.menu_items[0].children.push(e)):t.menuForm.menu_items[t.segmentIndex].children.push(e),t.closeModal())}).catch(s=>{t.menuItemErrors=s.response.data.errors})},updateSelectedMenu(e){this.selectedMenuItem.title=e.title,this.selectedMenuItem.type=e.type,this.selectedMenuItem.url=e.url,this.selectedMenuItem.is_blank=e.is_blank,this.selectedMenuItem.menu_itemable_id=e.menu_itemable_id},updateMenuItems(){const e=this;this.menuForm.post(route(this.baseRouteName+".update-menu-item"),{preserveScroll:!0,onStart:t=>{e.loader=e.$loading.show()},onSuccess:t=>{k(t.props.flash.message)},onFinish:t=>{e.loader.hide()}})}}},z={class:"columns"},R=o("div",{class:"column"},[o("div",{class:"is-pulled-left"},[o("b",null,"Menu Items"),o("br")])],-1),T={class:"column"},V={class:"columns"},w={class:"column"},j={class:"icon"};function q(e,t,s,a,n,i){const p=r("biz-language-tab"),h=r("navigation-segment"),g=r("biz-button"),f=r("navigation-form-duplicate");return c(),S("section",null,[o("div",z,[R,o("div",T,[u(p,{class:"is-right","locale-options":a.localeOptions,"selected-locale":n.selectedLocale,onOnChangeLocale:i.onChangeLocale},null,8,["locale-options","selected-locale","onOnChangeLocale"])])]),u(h,{"locale-options":a.localeOptions,"menu-items":n.menuForm.menu_items,menu:s.menu,"selected-locale":n.selectedLocale,onOpenDuplicateModal:i.openDuplicateModal},null,8,["locale-options","menu-items","menu","selected-locale","onOpenDuplicateModal"]),o("div",V,[o("div",w,[u(g,{class:"is-primary",disabled:i.hasMaxSegment,onClick:t[0]||(t[0]=_=>i.addSegment())},{default:x(()=>[o("span",j,[o("i",{class:N(a.icon.add)},null,2)]),I(" Â  Add new segment ")]),_:1},8,["disabled"])])]),e.isModalOpen?(c(),C(f,{key:0,errors:n.menuItemErrors,"locale-options":a.localeOptions,"menu-item":n.selectedMenuItem,onClose:t[1]||(t[1]=_=>e.closeModal()),onDuplicateMenuItem:i.duplicateMenuItem},null,8,["errors","locale-options","menu-item","onDuplicateMenuItem"])):O("",!0)])}const pe=B(E,[["render",q]]);export{pe as default};

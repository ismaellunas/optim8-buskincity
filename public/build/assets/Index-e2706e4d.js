import{M as J}from"./FilterDataHandle-94157290.js";import{M as X}from"./HasModal-fa56130c.js";import{M as Y}from"./HasPageErrors-da5616c1.js";import{A as Z}from"./AppLayout-40f8bbe7.js";import{B as $}from"./Button-03e0d3fd.js";import{B as ee}from"./ButtonDownload-7545f1b2.js";import{B as oe}from"./ButtonIcon-b1d1d2b0.js";import{B as te}from"./ButtonLink-abb08373.js";import{B as se}from"./Checkbox-8f917da5.js";import{B as re,a as ie}from"./Dropdown-034da47d.js";import{B as le}from"./DropdownScroll-6b0f6840.js";import{B as ne}from"./ErrorNotifications-090d6193.js";import{B as ae}from"./Field-e1691255.js";import{B as ce}from"./Search-4389f740.js";import{B as me}from"./FlashNotifications-b6fadc75.js";import{B as ue}from"./File-58357ba0.js";import{B as de}from"./Icon-6def3c13.js";import{B as he}from"./Input-4c73d710.js";import{B as fe}from"./ModalCard-06597c5e.js";import{B as pe}from"./TableIndex-c25c722c.js";import{B as _e}from"./Textarea-fb59ae31.js";import{l as z,B as v,H as B,z as I,f as h,p as i,i as o,q as r,w as C,m as be,y as ge,r as l,o as n,k as _,t as f,n as w,F as k,j as P,u as b,s as g,P as ye}from"./vue-loading.min-a6a947f0.js";import{a as M,s as x,c as N}from"./alert-fe3154bb.js";import{i as ke}from"./icon-class-4ab3933f.js";import{_ as ze}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasLoader-a564cfe6.js";import"./utils-caa7a80b.js";import"./Breadcrumbs-f0ae94d4.js";import"./Link-359d994c.js";import"./NavbarItem-766600c9.js";import"./Field-a8082082.js";import"./InputFile-216a7277.js";import"./InputError-9b7084c8.js";import"./Pagination-c4350b04.js";import"./Table-6b0ddb68.js";import"./TableInfo-6db2c6af.js";import"./sweetalert2.all-7b2d1616.js";const ve={components:{BizButton:$,BizButtonDownload:ee,BizButtonIcon:oe,BizButtonLink:te,BizCheckbox:se,BizDropdown:re,BizDropdownItem:ie,BizDropdownScroll:le,BizErrorNotifications:ne,BizField:ae,BizFilterSearch:ce,BizFlashNotifications:me,BizFormFile:ue,BizIcon:de,BizInput:he,BizModalCard:fe,BizTableIndex:pe,BizTextarea:_e},mixins:[J,X,Y],layout:Z,props:{baseRouteName:{type:String,required:!0},defaultLocale:{type:String,required:!0},groupOptions:{type:Object,default:()=>{}},referenceLocale:{type:String,required:!0},localeOptions:{type:Array,default:()=>[]},pageQueryParams:{type:Object,default:()=>{}},records:{type:Object,required:!0},title:{type:String,required:!0},i18n:{type:Object,default:()=>{}},bags:{type:Object,default:()=>{}}},setup(e){var a,c,m;const t=z.merge({},e.pageQueryParams);return{groups:v(((a=e.pageQueryParams)==null?void 0:a.groups)??[]),locale:v(((c=e.pageQueryParams)==null?void 0:c.locale)??e.defaultLocale),term:v(((m=e.pageQueryParams)==null?void 0:m.term)??""),queryParams:v(t),importForm:B({file:null})}},data(){return{isProcessing:!1,acceptedTypes:[".csv"],editIndex:null,form:B({translations:this.records.data}),icon:ke}},computed:{isReferenceLanguage(){return this.referenceLocale===this.locale},selectedLocale:{get(){const e=this.localeOptions.find(t=>t.id==this.locale);return(e==null?void 0:e.name)??""},set(e){this.locale=e.id}}},methods:{getUseForm(){return B({translations:this.records.data})},search(){this.form.isDirty?M().then(e=>{e.isConfirmed?(this.queryParams.groups=this.groups,this.queryParams.locale=this.locale,this.queryParams.term=this.term,this.refreshWithQueryParams()):(this.groups=this.queryParams.groups??[],this.locale=this.queryParams.locale??this.defaultLocale,this.term=this.queryParams.term??"")}):(this.queryParams.groups=this.groups,this.queryParams.locale=this.locale,this.queryParams.term=this.term,this.refreshWithQueryParams())},filterTerm:z.debounce(function(){this.search()},I),filterLocale:z.debounce(function(e){this.selectedLocale=e,this.search()},I),filterGroups:z.debounce(function(){this.search()},1400),refreshWithQueryParams(){this.$inertia.get(route(this.baseRouteName+".edit"),this.queryParams,{replace:!0,preserveState:!0,onStart:()=>this.onStartLoadingOverlay(),onFinish:()=>{this.onEndLoadingOverlay(),this.form=this.getUseForm()}})},onSubmit(){const e=this;e.form.post(route(e.baseRouteName+".update"),{preserveScroll:!1,onStart:()=>{e.loader=e.$loading.show()},onSuccess:t=>{x(t.props.flash.message),e.form=e.getUseForm()},onFinish:()=>{e.loader.hide()}})},onClear(e){const t=this;N("Are you sure?","The value will be cleared.").then(a=>{a.isConfirmed&&(t.form.translations[e].value=null)})},onDelete(e){const t=this;N("Are you sure?","It will delete all translation on another language.").then(c=>{c.isConfirmed&&t.$inertia.delete(route(t.baseRouteName+".destroy",e.id),{onSuccess:()=>{t.form=t.getUseForm()}})})},onClickedPagination(e){this.form.isDirty?M().then(t=>{t.isConfirmed&&this.refreshPagination(e)}):this.refreshPagination(e)},refreshPagination(e){this.$inertia.get(e,this.queryParams,{replace:!0,preserveState:!0,onFinish:()=>{this.form=this.getUseForm()}})},getImportForm(){return B({file:null})},onShownModal(){this.importForm=this.getImportForm()},submitImport(){const e=this;e.importForm.post(route(e.baseRouteName+".import"),{preserveScroll:!1,preserveState:!0,replace:!0,onStart:()=>{e.loader=e.$loading.show(),e.isProcessing=!0},onSuccess:t=>{x(t.props.flash.message),e.importForm.isDirty=!1,e.importForm.reset(),e.closeModal(),e.form=this.getUseForm()},onError:t=>{Object.keys(t).includes(e.bags.import)||e.closeModal()},onFinish:()=>{e.loader.hide(),e.isProcessing=!1}})}}},Be={class:"box"},Ce={class:"columns"},Pe={class:"column"},Se={class:"buttons is-right"},we=o("span",null,"Add New",-1),Fe=o("span",null,"Update",-1),qe={class:"columns"},Le={class:"column is-8"},Ve={class:"icon is-small"},Ie=o("span",null,"Group",-1),Me={key:0,class:"ml-1"},xe={class:"icon is-small"},Ne={class:"column is-4"},De=o("th",null,"#",-1),Oe=o("th",null,"Group",-1),Ue=o("th",null,"Key",-1),Re={key:0},Ee=o("th",null,"Value",-1),Te=o("th",null,[o("div",{class:"level-right"}," Actions ")],-1),je={class:"control is-expanded"},Qe={key:0},Ae={class:"control is-expanded"},Ge={class:"level-right"},He=o("p",{class:"modal-card-title"}," Import ",-1),We={class:"control"},Ke={class:"help is-info"},Je={class:"column p-0"},Xe={class:"buttons is-right"};function Ye(e,t,a,c,m,u){const D=l("biz-flash-notifications"),O=l("biz-error-notifications"),U=l("biz-button-download"),y=l("biz-button"),R=l("biz-icon"),E=l("biz-button-link"),S=l("biz-button-icon"),F=l("biz-dropdown-item"),q=l("biz-dropdown-scroll"),L=l("biz-dropdown"),T=l("biz-checkbox"),j=l("biz-filter-search"),Q=l("biz-input"),V=l("biz-field"),A=l("biz-textarea"),G=l("biz-table-index"),H=l("biz-form-file"),W=l("biz-modal-card");return n(),h("div",null,[i(D,{flash:e.$page.props.flash},null,8,["flash"]),i(O,{bags:["default"],errors:e.$page.props.errors},null,8,["errors"]),o("div",Be,[o("div",Ce,[o("div",Pe,[o("div",Se,[i(U,{url:e.route(a.baseRouteName+".export",{locale:c.locale,groups:c.groups}),class:"mr-2"},{default:r(()=>[_(" Export ")]),_:1},8,["url"]),i(y,{class:"mr-2",onClick:e.openModal},{default:r(()=>[_(" Import ")]),_:1},8,["onClick"]),i(E,{href:e.route(a.baseRouteName+".create"),class:"is-primary mr-2"},{default:r(()=>[i(R,{icon:m.icon.add},null,8,["icon"]),we]),_:1},8,["href"]),i(S,{class:"is-link",icon:m.icon.edit,onClick:u.onSubmit},{default:r(()=>[Fe]),_:1},8,["icon","onClick"])])])]),o("div",qe,[o("div",Le,[i(L,{"close-on-click":!0},{trigger:r(()=>[o("span",null,f(u.selectedLocale??"Language"),1),o("span",Ve,[o("i",{class:w(m.icon.angleDown),"aria-hidden":"true"},null,2)])]),default:r(()=>[i(q,{"max-height":350},{default:r(()=>[(n(!0),h(k,null,P(a.localeOptions,(s,d)=>(n(),b(F,{key:d,class:"pt-0 pb-1"},{default:r(()=>[i(y,{class:w(["is-fullwidth",s.id==c.locale?"is-link":"is-white"]),onClick:p=>u.filterLocale(s)},{default:r(()=>[_(f(s.name),1)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1})]),_:1}),i(L,{class:"ml-3","close-on-click":!1},{trigger:r(()=>[Ie,c.groups.length>0?(n(),h("span",Me," ("+f(c.groups.length)+") ",1)):g("",!0),o("span",xe,[o("i",{class:w(m.icon.angleDown),"aria-hidden":"true"},null,2)])]),default:r(()=>[i(q,{"max-height":350},{default:r(()=>[(n(!0),h(k,null,P(a.groupOptions,(s,d,p)=>(n(),b(F,{key:p},{default:r(()=>[i(T,{checked:c.groups,"onUpdate:checked":t[0]||(t[0]=K=>c.groups=K),value:d,onChange:u.filterGroups},{default:r(()=>[_(" Â  "+f(s),1)]),_:2},1032,["checked","value","onChange"])]),_:2},1024))),128))]),_:1})]),_:1})]),o("div",Ne,[i(j,{modelValue:c.term,"onUpdate:modelValue":t[1]||(t[1]=s=>c.term=s),onSearch:u.filterTerm},null,8,["modelValue","onSearch"])])]),o("form",{action:"post",onSubmit:t[2]||(t[2]=C((...s)=>u.onSubmit&&u.onSubmit(...s),["prevent"]))},[i(G,{"is-ajax-pagination":!0,"query-params":c.queryParams,records:a.records,onOnClickedPagination:u.onClickedPagination},{thead:r(()=>[o("tr",null,[De,Oe,Ue,u.isReferenceLanguage?g("",!0):(n(),h("th",Re," English Value ")),Ee,Te])]),default:r(()=>[(n(!0),h(k,null,P(a.records.data,(s,d)=>(n(),h("tr",{key:s.id},[o("th",null,f(s.id??"-"),1),o("td",null,f(s.group),1),o("td",null,[!s.group&&u.isReferenceLanguage?(n(),b(V,{key:0,class:"mb-0"},{default:r(()=>[o("div",je,[m.form.translations[d]?(n(),b(Q,{key:0,modelValue:m.form.translations[d].key,"onUpdate:modelValue":p=>m.form.translations[d].key=p,placeholder:"key"},null,8,["modelValue","onUpdate:modelValue"])):g("",!0)])]),_:2},1024)):(n(),h(k,{key:1},[_(f(s.key),1)],64))]),u.isReferenceLanguage?g("",!0):(n(),h("td",Qe,f(s.en_value??"-"),1)),o("td",null,[i(V,{class:"mb-0"},{default:r(()=>[o("div",Ae,[m.form.translations[d]?(n(),b(A,{key:0,modelValue:m.form.translations[d].value,"onUpdate:modelValue":p=>m.form.translations[d].value=p,placeholder:"value",style:{"min-width":"250px"},rows:"3"},null,8,["modelValue","onUpdate:modelValue"])):g("",!0)])]),_:2},1024)]),o("td",null,[o("div",Ge,[s.value?(n(),b(S,{key:0,type:"button",class:"is-ghost has-text-black ml-1",icon:m.icon.eraser,onClick:C(p=>u.onClear(d),["prevent"])},null,8,["icon","onClick"])):g("",!0),!s.group&&a.referenceLocale==s.locale?(n(),b(S,{key:1,type:"button",class:"is-ghost has-text-black ml-1",icon:m.icon.remove,onClick:C(p=>u.onDelete(s),["prevent"])},null,8,["icon","onClick"])):g("",!0)])])]))),128))]),_:1},8,["query-params","records","onOnClickedPagination"])],32)]),be(i(W,{onClose:t[6]||(t[6]=s=>e.closeModal())},{header:r(()=>[He,i(y,{"aria-label":"close",class:"delete is-primary",type:"button",onClick:e.closeModal},null,8,["onClick"])]),footer:r(()=>[o("div",Je,[o("div",Xe,[i(y,{class:"is-link",onClick:u.submitImport},{default:r(()=>[_(" Submit ")]),_:1},8,["onClick"]),i(y,{class:"is-link is-light ml-2",type:"button",onClick:t[5]||(t[5]=s=>e.closeModal())},{default:r(()=>[_(" Cancel ")]),_:1})])])]),default:r(()=>[o("form",{onSubmit:t[4]||(t[4]=C((...s)=>u.submitImport&&u.submitImport(...s),["prevent"]))},[o("div",We,[i(H,{modelValue:c.importForm.file,"onUpdate:modelValue":t[3]||(t[3]=s=>c.importForm.file=s),"accepted-types":m.acceptedTypes,message:e.error("file",a.bags.import),label:"File",required:""},ye({_:2},[a.i18n.fileInputNotes?{name:"note",fn:r(()=>[o("p",Ke,[o("ul",null,[(n(!0),h(k,null,P(a.i18n.fileInputNotes,s=>(n(),h("li",{key:s},f(s),1))),128))])])]),key:"0"}:void 0]),1032,["modelValue","accepted-types","message"])])],32)]),_:1},512),[[ge,e.isModalOpen]])])}const Do=ze(ve,[["render",Ye]]);export{Do as default};

import{A as y}from"./AppLayout-25ccdbdb.js";import{B}from"./Button-b3acaac2.js";import{B as P}from"./ButtonLink-71ebb617.js";import{B as U}from"./ErrorNotifications-805a6bc2.js";import{F as k}from"./Builder-1554b87b.js";import V from"./FormPassword-d8973be8.js";import z from"./FormProfile-ddf1fe14.js";import{s as f}from"./alert-e0e75cb7.js";import{H as _,f as h,p as l,i as r,w as g,q as a,s as N,m as O,y as x,u as A,r as n,o as c,k as p}from"./vue-loading.min-aa20e13d.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./Breadcrumbs-0b4348b1.js";import"./Link-2bcf0cab.js";import"./utils-79a9c8b1.js";import"./NavbarItem-7e983d41.js";import"./LanguageTab-090d99fd.js";import"./HasLoader-a564cfe6.js";import"./FieldGroup-38323628.js";import"./CheckboxToggle-c45bd847.js";import"./CheckboxToggle-b36e31d6.js";import"./Field-fbae01a6.js";import"./Field-c2e062a9.js";import"./InputError-bc1e9f36.js";import"./HasPageErrors-4d447fdf.js";import"./Checkbox-8d9a17c8.js";import"./Icon-150b61ef.js";import"./Input-50a73630.js";import"./Input-2fb71e37.js";import"./ButtonIcon-05c24ca4.js";import"./InputFile-1187b7e3.js";import"./FileUpload-9bbd68fd.js";import"./Gallery-48abb118.js";import"./HasModal-fa56130c.js";import"./ButtonDownload-ab8e1361.js";import"./Image-52e0dacd.js";import"./Modal-247c5739.js";import"./Number-44d52d35.js";import"./Number-2731510a.js";import"./Phone-f71a3985.js";import"./Dropdown-5425ae3a.js";import"./DropdownScroll-6bec070e.js";import"./DropdownSearch-bd4068c6.js";import"./icon-class-4ab3933f.js";import"./Radio-9ae6607f.js";import"./Select-c82d82bb.js";import"./Select-9fda6861.js";import"./Textarea-18e9b25c.js";import"./Textarea-3c29db5c.js";import"./Password-7112046e.js";import"./DropdownSearch-783ef1d1.js";import"./ImageSquare-ffa664e1.js";import"./ModalCard-42b1747b.js";import"./cropper-5d594675.js";import"./sweetalert2.all-ebd52f41.js";const E={name:"UserEdit",components:{BizButton:B,BizButtonLink:P,BizErrorNotifications:U,FormBuilder:k,FormUserPassword:V,FormUserProfile:z},layout:y,props:{can:{type:Object,required:!0},errors:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}},roleOptions:{type:Array,default:()=>[]},supportedLanguageOptions:{type:Array,default:()=>[]},title:{type:String,required:!0}},setup(o){const e={_method:"put",first_name:o.record.first_name,last_name:o.record.last_name,email:o.record.email,photo:null,is_photo_deleted:!1,language_id:o.record.language_id};return o.record.isSuperAdministrator||(e.role=o.record.roles[0]?o.record.roles[0].id:null),{profileForm:_(e),passwordForm:_({password:null,password_confirmation:null})}},data(){return{baseRouteName:"admin.users",biodataFormKey:0,errorBag:"userUpdate",photoUrl:this.record.profile_photo_url,isFormBuilderShown:!1,isProcessing:!1,loader:null}},methods:{onSubmit(){const o=this;o.profileForm.post(route(o.baseRouteName+".update",o.record.id),{preserveScroll:!1,onStart:()=>{o.loader=o.$loading.show(),o.isProcessing=!0},onSuccess:e=>{f(e.props.flash.message),o.profileForm.isDirty=!1,o.profileForm.photo=null,o.profileForm.is_photo_deleted=!1,o.photoUrl=o.record.profile_photo_url,o.biodataFormKey+=1},onFinish:()=>{o.loader.hide(),o.isProcessing=!1}})},onPasswordSubmit(){const o=this,e=o.passwordForm;e.put(route(o.baseRouteName+".password",o.record.id),{preserveScroll:!1,onStart:()=>{o.loader=o.$loading.show(),o.isProcessing=!0},onSuccess:t=>{f(t.props.flash.message),e.isDirty=!1,e.reset()},onFinish:()=>{o.loader.hide(),o.isProcessing=!1}})}}},C={class:"mb-6"},R={class:"column"},j=["disabled"],q=r("h3",{class:"title is-3"},"Profile",-1),D=r("hr",null,null,-1),K={class:"field is-grouped is-grouped-right"},H={class:"control"},M={class:"control"},T={class:"column"},G=["disabled"],I=r("h3",{class:"title is-3"},"Password",-1),J=r("hr",null,null,-1),Q={class:"field is-grouped is-grouped-right"},W={class:"control"},X={class:"columns"},Y={class:"column"},Z=["disabled"],$=r("h3",{class:"title is-3"}," Profile ",-1),oo=r("hr",null,null,-1),ro={class:"field is-grouped is-grouped-right"},eo={class:"control"};function so(o,e,t,d,s,m){const b=n("biz-error-notifications"),F=n("form-user-profile"),w=n("biz-button-link"),u=n("biz-button"),S=n("form-user-password"),v=n("form-builder");return c(),h("div",null,[l(b,{bags:["userUpdate"],errors:o.$page.props.errors},null,8,["errors"]),r("div",C,[r("form",{class:"columns",method:"post",onSubmit:e[1]||(e[1]=g((...i)=>m.onSubmit&&m.onSubmit(...i),["prevent"]))},[r("div",R,[r("fieldset",{class:"box",disabled:s.isProcessing},[q,D,l(F,{modelValue:d.profileForm,"onUpdate:modelValue":e[0]||(e[0]=i=>d.profileForm=i),"can-set-role":!t.record.isSuperAdministrator,"photo-url":s.photoUrl,"role-options":t.roleOptions,"language-options":t.supportedLanguageOptions,"error-bag":s.errorBag,"profile-page-url":t.can.public_profile?t.record.profilePageUrl:null},null,8,["modelValue","can-set-role","photo-url","role-options","language-options","error-bag","profile-page-url"]),r("div",K,[r("div",H,[l(w,{href:o.route(s.baseRouteName+".index"),class:"is-link is-light"},{default:a(()=>[p(" Cancel ")]),_:1},8,["href"])]),r("div",M,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])],8,j)])],32),t.can.update_password?(c(),h("form",{key:0,class:"columns",method:"post",onSubmit:e[3]||(e[3]=g((...i)=>m.onPasswordSubmit&&m.onPasswordSubmit(...i),["prevent"]))},[r("div",T,[r("fieldset",{class:"box",disabled:s.isProcessing},[I,J,l(S,{modelValue:d.passwordForm,"onUpdate:modelValue":e[2]||(e[2]=i=>d.passwordForm=i),"error-bag":s.errorBag},null,8,["modelValue","error-bag"]),r("div",Q,[r("div",W,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])],8,G)])],32)):N("",!0),O(r("div",X,[r("div",Y,[r("fieldset",{class:"box",disabled:s.isProcessing},[$,oo,(c(),A(v,{key:s.biodataFormKey,"route-name":"admin.users.edit","entity-id":t.record.id,locale:o.$page.props.user.origin_language_code,onLoadedEmptyField:e[4]||(e[4]=i=>s.isFormBuilderShown=!1),onLoadedSuccessfully:e[5]||(e[5]=i=>s.isFormBuilderShown=!0)},{buttons:a(()=>[r("div",ro,[r("div",eo,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])]),_:1},8,["entity-id","locale"]))],8,Z)])],512),[[x,s.isFormBuilderShown]])])])}const tr=L(E,[["render",so]]);export{tr as default};

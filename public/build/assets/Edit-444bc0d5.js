import{A as y}from"./AppLayout-40f8bbe7.js";import{B}from"./Button-03e0d3fd.js";import{B as P}from"./ButtonLink-abb08373.js";import{B as U}from"./ErrorNotifications-090d6193.js";import{F as k}from"./Builder-efcb9748.js";import V from"./FormPassword-e4b14997.js";import z from"./FormProfile-bcc9c01a.js";import{s as f}from"./alert-fe3154bb.js";import{H as _,f as h,p as l,i as r,w as g,q as a,s as N,m as O,y as x,u as A,r as n,o as c,k as p}from"./vue-loading.min-a6a947f0.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./Breadcrumbs-f0ae94d4.js";import"./Link-359d994c.js";import"./utils-caa7a80b.js";import"./NavbarItem-766600c9.js";import"./LanguageTab-ce3e8bfb.js";import"./HasLoader-a564cfe6.js";import"./FieldGroup-eaa7223f.js";import"./CheckboxToggle-cf2f3b67.js";import"./CheckboxToggle-2a77e04a.js";import"./Field-a8082082.js";import"./Field-e1691255.js";import"./InputError-9b7084c8.js";import"./HasPageErrors-da5616c1.js";import"./Checkbox-8f917da5.js";import"./Icon-6def3c13.js";import"./Input-137492c5.js";import"./Input-4c73d710.js";import"./ButtonIcon-b1d1d2b0.js";import"./InputFile-216a7277.js";import"./FileUpload-a010d5e2.js";import"./Gallery-86a7e0a4.js";import"./HasModal-fa56130c.js";import"./ButtonDownload-7545f1b2.js";import"./Image-c2b8efed.js";import"./Modal-655bec1f.js";import"./Number-d98ba32a.js";import"./Number-91e213dc.js";import"./Phone-6da95ea8.js";import"./Dropdown-034da47d.js";import"./DropdownScroll-6b0f6840.js";import"./DropdownSearch-d54bf8fb.js";import"./icon-class-4ab3933f.js";import"./Radio-6fefdefd.js";import"./Select-a178b677.js";import"./Select-19a91b6e.js";import"./Textarea-0e8af5bc.js";import"./Textarea-fb59ae31.js";import"./Password-6c802cd8.js";import"./DropdownSearch-eb09b8b3.js";import"./ImageSquare-b4e4050d.js";import"./ModalCard-06597c5e.js";import"./cropper-72988d76.js";import"./sweetalert2.all-7b2d1616.js";const E={name:"UserEdit",components:{BizButton:B,BizButtonLink:P,BizErrorNotifications:U,FormBuilder:k,FormUserPassword:V,FormUserProfile:z},layout:y,props:{can:{type:Object,required:!0},errors:{type:Object,default:()=>{}},record:{type:Object,default:()=>{}},roleOptions:{type:Array,default:()=>[]},supportedLanguageOptions:{type:Array,default:()=>[]},title:{type:String,required:!0}},setup(o){const e={_method:"put",first_name:o.record.first_name,last_name:o.record.last_name,email:o.record.email,photo:null,is_photo_deleted:!1,language_id:o.record.language_id};return o.record.isSuperAdministrator||(e.role=o.record.roles[0]?o.record.roles[0].id:null),{profileForm:_(e),passwordForm:_({password:null,password_confirmation:null})}},data(){return{baseRouteName:"admin.users",biodataFormKey:0,errorBag:"userUpdate",photoUrl:this.record.profile_photo_url,isFormBuilderShown:!1,isProcessing:!1,loader:null}},methods:{onSubmit(){const o=this;o.profileForm.post(route(o.baseRouteName+".update",o.record.id),{preserveScroll:!1,onStart:()=>{o.loader=o.$loading.show(),o.isProcessing=!0},onSuccess:e=>{f(e.props.flash.message),o.profileForm.isDirty=!1,o.profileForm.photo=null,o.profileForm.is_photo_deleted=!1,o.photoUrl=o.record.profile_photo_url,o.biodataFormKey+=1},onFinish:()=>{o.loader.hide(),o.isProcessing=!1}})},onPasswordSubmit(){const o=this,e=o.passwordForm;e.put(route(o.baseRouteName+".password",o.record.id),{preserveScroll:!1,onStart:()=>{o.loader=o.$loading.show(),o.isProcessing=!0},onSuccess:t=>{f(t.props.flash.message),e.isDirty=!1,e.reset()},onFinish:()=>{o.loader.hide(),o.isProcessing=!1}})}}},C={class:"mb-6"},R={class:"column"},j=["disabled"],q=r("h3",{class:"title is-3"},"Profile",-1),D=r("hr",null,null,-1),K={class:"field is-grouped is-grouped-right"},H={class:"control"},M={class:"control"},T={class:"column"},G=["disabled"],I=r("h3",{class:"title is-3"},"Password",-1),J=r("hr",null,null,-1),Q={class:"field is-grouped is-grouped-right"},W={class:"control"},X={class:"columns"},Y={class:"column"},Z=["disabled"],$=r("h3",{class:"title is-3"}," Profile ",-1),oo=r("hr",null,null,-1),ro={class:"field is-grouped is-grouped-right"},eo={class:"control"};function so(o,e,t,d,s,m){const b=n("biz-error-notifications"),F=n("form-user-profile"),w=n("biz-button-link"),u=n("biz-button"),S=n("form-user-password"),v=n("form-builder");return c(),h("div",null,[l(b,{bags:["userUpdate"],errors:o.$page.props.errors},null,8,["errors"]),r("div",C,[r("form",{class:"columns",method:"post",onSubmit:e[1]||(e[1]=g((...i)=>m.onSubmit&&m.onSubmit(...i),["prevent"]))},[r("div",R,[r("fieldset",{class:"box",disabled:s.isProcessing},[q,D,l(F,{modelValue:d.profileForm,"onUpdate:modelValue":e[0]||(e[0]=i=>d.profileForm=i),"can-set-role":!t.record.isSuperAdministrator,"photo-url":s.photoUrl,"role-options":t.roleOptions,"language-options":t.supportedLanguageOptions,"error-bag":s.errorBag,"profile-page-url":t.can.public_profile?t.record.profilePageUrl:null},null,8,["modelValue","can-set-role","photo-url","role-options","language-options","error-bag","profile-page-url"]),r("div",K,[r("div",H,[l(w,{href:o.route(s.baseRouteName+".index"),class:"is-link is-light"},{default:a(()=>[p(" Cancel ")]),_:1},8,["href"])]),r("div",M,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])],8,j)])],32),t.can.update_password?(c(),h("form",{key:0,class:"columns",method:"post",onSubmit:e[3]||(e[3]=g((...i)=>m.onPasswordSubmit&&m.onPasswordSubmit(...i),["prevent"]))},[r("div",T,[r("fieldset",{class:"box",disabled:s.isProcessing},[I,J,l(S,{modelValue:d.passwordForm,"onUpdate:modelValue":e[2]||(e[2]=i=>d.passwordForm=i),"error-bag":s.errorBag},null,8,["modelValue","error-bag"]),r("div",Q,[r("div",W,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])],8,G)])],32)):N("",!0),O(r("div",X,[r("div",Y,[r("fieldset",{class:"box",disabled:s.isProcessing},[$,oo,(c(),A(v,{key:s.biodataFormKey,"route-name":"admin.users.edit","entity-id":t.record.id,locale:o.$page.props.user.origin_language_code,onLoadedEmptyField:e[4]||(e[4]=i=>s.isFormBuilderShown=!1),onLoadedSuccessfully:e[5]||(e[5]=i=>s.isFormBuilderShown=!0)},{buttons:a(()=>[r("div",ro,[r("div",eo,[l(u,{class:"is-link"},{default:a(()=>[p(" Update ")]),_:1})])])]),_:1},8,["entity-id","locale"]))],8,Z)])],512),[[x,s.isFormBuilderShown]])])])}const tr=L(E,[["render",so]]);export{tr as default};

import{M as L}from"./FilterDataHandle-94157290.js";import{M as P}from"./HasModal-fa56130c.js";import{B as R}from"./ButtonIcon-b1d1d2b0.js";import{B as F}from"./ButtonLink-abb08373.js";import{B as q}from"./Checkbox-8f917da5.js";import{B as V,a as I}from"./Dropdown-034da47d.js";import{B as Q}from"./Search-4389f740.js";import{B as j}from"./Icon-6def3c13.js";import{B as A}from"./TableIndex-c25c722c.js";import T from"./ModalFormDelete-820e9449.js";import H from"./ListItem-ae56ad0b.js";import{i as W}from"./icon-class-4ab3933f.js";import{o as G,s as J,c as b}from"./alert-fe3154bb.js";import{l as K,B as y,f as h,i as t,p as u,q as a,u as p,s as m,r as c,o as n,t as U,k as B,F as g,j as S,n as x,w as k}from"./vue-loading.min-a6a947f0.js";import{_ as X}from"./_plugin-vue_export-helper-c27b6911.js";import"./HasLoader-a564cfe6.js";import"./Button-03e0d3fd.js";import"./Link-359d994c.js";import"./utils-caa7a80b.js";import"./Field-e1691255.js";import"./Input-4c73d710.js";import"./Pagination-c4350b04.js";import"./Table-6b0ddb68.js";import"./TableInfo-6db2c6af.js";import"./HasPageErrors-da5616c1.js";import"./Select-a178b677.js";import"./Field-a8082082.js";import"./InputError-9b7084c8.js";import"./Select-19a91b6e.js";import"./ModalCard-06597c5e.js";import"./Radio-6fefdefd.js";import"./Tag-8100534e.js";import"./sweetalert2.all-7b2d1616.js";const Y={name:"UserList",components:{BizButtonIcon:R,BizButtonLink:F,BizCheckbox:q,BizDropdown:V,BizDropdownItem:I,BizFilterSearch:Q,BizIcon:j,BizTableIndex:A,ModalFormDelete:T,UserListItem:H},mixins:[L,P],inject:["baseRouteName","can","roleOptions"],props:{pageQueryParams:{type:Object,required:!0},records:{type:Object,default:()=>{}}},setup(s){var l,r;const e=K.merge({},s.pageQueryParams);return{queryParams:y(e),roles:y(((l=s.pageQueryParams)==null?void 0:l.roles)??[]),term:y(((r=s.pageQueryParams)==null?void 0:r.term)??null)}},data(){return{icon:W,seletectedUser:null}},methods:{deleteUserModal(s){this.selectedUser=s,this.openModal()},onError(s){G()},onSuccess(s){J(s.props.flash.message),this.closeModal()},onRoleChanged(s){this.queryParams.roles=this.roles,this.refreshWithQueryParams()},deleteUser(s){const e=this;b("Are you sure?",'Once you hit "Confirm Deletion", the user will be permanently removed.',"Confirm Deletion").then(l=>{if(l.isConfirmed){const r=this.selectedUser.id;s.delete(route(e.baseRouteName+".destroy",r),{onStart:e.onStartLoadingOverlay,onFinish:()=>{e.onEndLoadingOverlay()},onError:e.onError,onSuccess:e.onSuccess})}})},suspendUser(s){const e=this;b("Are you sure?","The user will be suspended.").then(l=>{l.isConfirmed&&e.$inertia.post(route(e.baseRouteName+".suspend",s.id),{},{onStart:e.onStartLoadingOverlay,onFinish:e.onEndLoadingOverlay,onError:e.onError,onSuccess:e.onSuccess})})},unsuspendUser(s){const e=this;b("Are you sure?","The user will be unsuspended.").then(l=>{l.isConfirmed&&e.$inertia.post(route(e.baseRouteName+".unsuspend",s.id),{},{onStart:e.onStartLoadingOverlay,onFinish:e.onEndLoadingOverlay,onError:e.onError,onSuccess:e.onSuccess})})}}},Z={class:"columns"},$={class:"column"},ee={class:"column"},se=t("span",null,"Filter",-1),oe={key:0,class:"ml-1"},te={class:"column has-text-right"},ne=t("span",null,"Create New",-1),re=t("tr",null,[t("th",null,"#"),t("th",null,"Name"),t("th",null,"Email"),t("th",null,"Role"),t("th",null,[t("div",{class:"level-right"}," Actions ")])],-1),ie={class:"level-right"},le=["href"],ae={class:"icon is-small"};function ce(s,e,l,r,d,i){const w=c("biz-filter-search"),v=c("biz-icon"),z=c("biz-dropdown-item"),E=c("biz-checkbox"),M=c("biz-dropdown"),C=c("biz-button-link"),f=c("biz-button-icon"),N=c("user-list-item"),D=c("biz-table-index"),O=c("modal-form-delete");return n(),h("div",null,[t("div",Z,[t("div",$,[u(w,{modelValue:r.term,"onUpdate:modelValue":e[0]||(e[0]=o=>r.term=o),onSearch:s.search},null,8,["modelValue","onSearch"])]),t("div",ee,[u(M,{"close-on-click":!1},{trigger:a(()=>[se,r.roles.length>0?(n(),h("span",oe," ("+U(r.roles.length)+") ",1)):m("",!0),u(v,{icon:d.icon.angleDown},null,8,["icon"])]),default:a(()=>[u(z,null,{default:a(()=>[B(" Filter by Role ")]),_:1}),(n(!0),h(g,null,S(i.roleOptions,o=>(n(),p(z,{key:o.id},{default:a(()=>[u(E,{checked:r.roles,"onUpdate:checked":e[1]||(e[1]=_=>r.roles=_),value:o.id,onChange:i.onRoleChanged},{default:a(()=>[B(" Â  "+U(o.value),1)]),_:2},1032,["checked","value","onChange"])]),_:2},1024))),128))]),_:1})]),t("div",te,[i.can.add?(n(),p(C,{key:0,class:"is-primary",href:s.route(i.baseRouteName+".create")},{default:a(()=>[u(v,{icon:d.icon.add},null,8,["icon"]),ne]),_:1},8,["href"])):m("",!0)])]),u(D,{records:l.records,"query-params":r.queryParams},{thead:a(()=>[re]),default:a(()=>[(n(!0),h(g,null,S(l.records.data,o=>(n(),p(N,{key:o.id,user:o},{actions:a(()=>[t("div",ie,[o.can.public_profile?(n(),h("a",{key:0,class:"button is-ghost has-text-black ml-1",target:"_blank",title:"Profile Page Url",href:o.profile_page_url},[t("i",{class:x(d.icon.idCard)},null,2)],8,le)):m("",!0),i.can.edit?(n(),p(C,{key:1,class:"is-ghost has-text-black",href:s.route(i.baseRouteName+".edit",o.id)},{default:a(()=>[t("span",ae,[t("i",{class:x(d.icon.edit)},null,2)])]),_:2},1032,["href"])):m("",!0),i.can.delete&&o.can.delete_user?(n(),h(g,{key:2},[u(f,{class:"is-ghost has-text-black ml-1","icon-class":"is-small",icon:d.icon.remove,title:"Delete User",onClick:k(_=>i.deleteUserModal(o),["prevent"])},null,8,["icon","onClick"]),o.is_suspended?m("",!0):(n(),p(f,{key:0,class:"is-ghost has-text-black ml-1","icon-class":"is-small",icon:d.icon.suspend,title:"Suspend User",onClick:k(_=>i.suspendUser(o),["prevent"])},null,8,["icon","onClick"])),o.is_suspended?(n(),p(f,{key:1,class:"is-ghost has-text-black ml-1","icon-class":"is-small",icon:d.icon.unsuspend,title:"Unsuspend User",onClick:k(_=>i.unsuspendUser(o),["prevent"])},null,8,["icon","onClick"])):m("",!0)],64)):m("",!0)])]),_:2},1032,["user"]))),128))]),_:1},8,["records","query-params"]),s.isModalOpen?(n(),p(O,{key:0,"get-candidates-route":i.baseRouteName+".reassignment-candidates",user:s.selectedUser,onClose:s.closeModal,onDeleteUser:i.deleteUser},null,8,["get-candidates-route","user","onClose","onDeleteUser"])):m("",!0)])}const Ae=X(Y,[["render",ce]]);export{Ae as default};

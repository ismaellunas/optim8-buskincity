import{B as D}from"./Button-b3acaac2.js";import{B as w}from"./Datepicker-847140ac.js";import{B as z}from"./Field-c2e062a9.js";import{B as k}from"./FieldHorizontal-b8491cae.js";import{M as C}from"./HasLoader-a564cfe6.js";import{h as m}from"./moment-fbc5633a.js";import{B as c,f as h,i,p as n,q as l,F as T,j as I,r as u,o as f,k as p,t as B,n as S,u as V,s as M}from"./vue-loading.min-aa20e13d.js";import{u as q}from"./utils-79a9c8b1.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const R={components:{BizButton:D,BizDatepicker:w,BizField:z,BizFormFieldHorizontal:k},mixins:[C],props:{modelValue:{type:Object,required:!0},allowedDatesRoute:{type:String,required:!0},availableTimesRoute:{type:String,required:!0},availableTimesParam:{type:Object,required:!0},minDate:{type:String,required:!0},maxDate:{type:String,required:!0},productId:{type:Number,required:!0}},emits:["on-time-confirmed"],setup(e,{emit:t}){return{allowedDates:c([]),availableTimes:c([]),form:q(e,t),isCalendarDisabled:c(!1),selectedIndex:c(null),yearRange:[m(e.minDate).year(),m(e.maxDate).year()]}},watch:{"form.date":function(e,t){this.resetSelectedIndex(),this.getAvailableTimes()}},async mounted(){const e=m(this.minDate);this.allowedDates=await this.getAllowedDates(e.month()+1,e.year())},methods:{getAvailableTimes(){this.form.date||(this.availableTimes=[]);const e=this,t={...this.availableTimesParam,date:m(this.form.date).format("YYYY-MM-DD")};e.onStartLoadingOverlay(),e.isCalendarDisabled=!0,axios.get(route(e.availableTimesRoute,t)).then(a=>{e.availableTimes=a.data}).then(()=>{e.onEndLoadingOverlay(),e.isCalendarDisabled=!1})},isIndexSelected(e){return this.selectedIndex==e},resetSelectedIndex(){this.selectedIndex=null},toggleSelectedIndex(e){this.selectedIndex==e?this.resetSelectedIndex():this.selectedIndex=e},getTimeClasses(e){return{"is-danger":this.isIndexSelected(e),"has-text-weight-bold":this.isIndexSelected(e)}},confirmTime(e){this.form.time=e,this.$emit("on-time-confirmed")},async getAllowedDates(e,t){const a=this,s=route(this.allowedDatesRoute,{product:this.productId,month:e,year:t});a.isCalendarDisabled=!0;const b=await axios.get(s);return a.isCalendarDisabled=!1,b.data},async handleMonthYear({instance:e,month:t,year:a}){this.allowedDates=await this.getAllowedDates(t+1,a)}}},A={class:"booking-time columns"},F={class:"column is-7"},N={class:"control"},L={class:"control is-expanded"},O=["value"],j={id:"reschedule-available-time-list-wrapper",class:"column is-5"},U={id:"reschedule-available-time-list",class:"columns is-multiline"},E={class:"buttons"};function H(e,t,a,s,b,o){const y=u("biz-datepicker"),_=u("biz-field"),x=u("biz-form-field-horizontal"),g=u("biz-button");return f(),h("div",A,[i("div",F,[n(_,{class:"is-grouped is-grouped-centered"},{default:l(()=>[i("p",N,[n(y,{modelValue:s.form.date,"onUpdate:modelValue":t[0]||(t[0]=r=>s.form.date=r),"auto-apply":"","hide-offset-dates":"",inline:"","month-name-format":"long","no-today":"","prevent-min-max-navigation":"","allowed-dates":s.allowedDates,disabled:s.isCalendarDisabled,"enable-time-picker":!1,"max-date":a.maxDate,"min-date":a.minDate,"month-change-on-scroll":!1,"year-range":s.yearRange,onUpdateMonthYear:o.handleMonthYear},null,8,["modelValue","allowed-dates","disabled","max-date","min-date","year-range","onUpdateMonthYear"])])]),_:1}),n(_,{class:"is-grouped is-grouped-centered"},{default:l(()=>[n(x,{class:"timezone-info"},{label:l(()=>[p(" Timezone ")]),default:l(()=>[i("p",L,[i("input",{class:"input",type:"text",value:s.form.timezone,readonly:"",disabled:""},null,8,O)])]),_:1})]),_:1})]),i("div",j,[i("div",U,[(f(!0),h(T,null,I(s.availableTimes,(r,d)=>(f(),h("div",{key:d,class:"column is-full py-1"},[i("div",E,[n(g,{class:S(["px-5",o.getTimeClasses(d)]),type:"button",onClick:v=>o.toggleSelectedIndex(d)},{default:l(()=>[p(B(r),1)]),_:2},1032,["class","onClick"]),o.isIndexSelected(d)?(f(),V(g,{key:0,class:"button is-link px-5",type:"button",onClick:v=>o.confirmTime(r)},{default:l(()=>[p(" Confirm ")]),_:2},1032,["onClick"])):M("",!0)])]))),128))])])])}const ee=Y(R,[["render",H]]);export{ee as default};
